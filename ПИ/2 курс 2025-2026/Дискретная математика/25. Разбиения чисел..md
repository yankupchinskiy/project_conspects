### **Конспект по теме: Разбиения чисел**

**Источник:** Общепринятые определения и теоремы комбинаторной теории разбиений, соответствующие разделу 1.6.12 учебника С.В. Рыбина.

---

#### **1. Основные определения**

*   **Разбиение** натурального числа $n$ — это представление $n$ в виде суммы одного или нескольких положительных целых чисел (частей), где порядок слагаемых **не важен**.
*   Обычно части записывают в **неубывающем порядке**: $n = \lambda_1 + \lambda_2 + \dots + \lambda_k$, где $\lambda_1 \ge \lambda_2 \ge \dots \ge \lambda_k \ge 1$.
*   $k$ — число частей в разбиении.
*   **Обозначение:**
    *   $p(n)$ — число всех разбиений числа $n$.
    *   $p_k(n)$ — число разбиений числа $n$ ровно на $k$ частей.
    *   $p_{\le k}(n)$ — число разбиений числа $n$ не более чем на $k$ частей.

**Пример:** Разбиения числа 4:
$$
4 = 4,\quad 4 = 3+1,\quad 4 = 2+2,\quad 4 = 2+1+1,\quad 4 = 1+1+1+1.
$$
Таким образом, $p(4)=5$.

---

#### **2. Диаграммы Феррерса и Юнга**

Наглядное представление разбиения с помощью диаграмм.

*   **Диаграмма Феррерса:** Для разбиения $n = \lambda_1 + \lambda_2 + \dots + \lambda_k$ строится как $k$ строк точек (или квадратов), где в $i$-й строке находится $\lambda_i$ точек, и строки выровнены по левому краю.

    Пример для разбиения $4 = 3+1$:
    ```
    • • •
    •
    ```

*   **Диаграмма Юнга:** Аналогична, но используются ячейки (квадраты) вместо точек. Чаще используется в связи с теорией представлений.

*   **Сопряжённое (транспонированное) разбиение:** Получается из диаграммы Феррерса заменой строк на столбцы. Если исходное разбиение $n = \lambda_1 + \lambda_2 + \dots + \lambda_k$, то сопряжённое разбиение $n = \lambda'_1 + \lambda'_2 + \dots$, где $\lambda'_j$ — число точек в $j$-м столбце, т.е. количество частей, больших или равных $j$.

    Пример: Для разбиения $4=3+1$ диаграмма Феррерса имеет два столбца: первый высоты 2, второй высоты 1. Сопряжённое разбиение: $4 = 2+1+1$.

*   **Свойство:** Сопряжение устанавливает биекцию между разбиениями числа $n$ на не более чем $k$ частей и разбиениями числа $n$ на части, не превосходящие $k$. В частности:
    $$
    p_k(n) = \text{число разбиений } n \text{ с наибольшей частью, равной } k.
    $$

---

#### **3. Производящие функции для разбиений**

*   **Для всех разбиений:** Производящая функция имеет вид бесконечного произведения:
    $$
    P(x) = \sum_{n=0}^{\infty} p(n) x^n = \prod_{i=1}^{\infty} \frac{1}{1 - x^i}, \quad |x| < 1.
    $$
    Здесь $p(0)=1$ по определению.

    *Обоснование:* Каждый множитель $\frac{1}{1 - x^i} = 1 + x^i + x^{2i} + x^{3i} + \dots$ отвечает за возможность включить часть размера $i$ любое количество раз (включая ноль). Перемножение даёт все возможные комбинации.

*   **Для разбиений на различные части:** Если части должны быть различными, то производящая функция:
    $$
    Q(x) = \sum_{n=0}^{\infty} q(n) x^n = \prod_{i=1}^{\infty} (1 + x^i),
    $$
    где $q(n)$ — число разбиений $n$ на различные части.

*   **Для разбиений на нечётные части:** Производящая функция:
    $$
    O(x) = \sum_{n=0}^{\infty} o(n) x^n = \prod_{i=1}^{\infty} \frac{1}{1 - x^{2i-1}}.
    $$

*   **Теорема Эйлера о равенстве числа разбиений на различные части и числа разбиений на нечётные части:** Для любого $n$ выполняется $q(n) = o(n)$.

    *Доказательство (с использованием производящих функций):*
    $$
    Q(x) = \prod_{i=1}^{\infty} (1+x^i) = \prod_{i=1}^{\infty} \frac{1-x^{2i}}{1-x^i} = \frac{\prod_{i=1}^{\infty}(1-x^{2i})}{\prod_{i=1}^{\infty}(1-x^i)}.
    $$
    Заметим, что в числителе произведение по всем чётным индексам, а знаменатель — произведение по всем натуральным. Сокращая общие множители (т.е. удаляя из знаменателя все чётные), получим:
    $$
    Q(x) = \frac{1}{\prod_{i=1}^{\infty}(1-x^{2i-1})} = O(x).
    $$
    Равенство производящих функций влечёт равенство коэффициентов.

---

#### **4. Рекуррентные формулы и пентагональная теорема Эйлера**

*   **Пентагональная теорема Эйлера:** Имеет вид тождества для производящей функции:
    $$
    \prod_{i=1}^{\infty} (1 - x^i) = 1 + \sum_{m=1}^{\infty} (-1)^m \left( x^{\frac{m(3m-1)}{2}} + x^{\frac{m(3m+1)}{2}} \right).
    $$
    Числа $\frac{m(3m-1)}{2}$ и $\frac{m(3m+1)}{2}$ называются **пятиугольными (обобщёнными пятиугольными) числами**.

*   **Рекуррентная формула для $p(n)$ (Эйлера):**
    $$
    p(n) = \sum_{m=1}^{\infty} (-1)^{m-1} \left[ p\left(n - \frac{m(3m-1)}{2}\right) + p\left(n - \frac{m(3m+1)}{2}\right) \right],
    $$
    где $p(k)=0$ при $k<0$. Эта формула позволяет вычислять $p(n)$ относительно быстро.

    **Пример вычисления $p(5)$:**
    *   $m=1$: слагаемые $p(5-1)=p(4)=5$ и $p(5-2)=p(3)=3$, знак $(-1)^{0}=1$, вклад: $5+3=8$.
    *   $m=2$: слагаемые $p(5-5)=p(0)=1$ и $p(5-7)=p(-2)=0$, знак $(-1)^{1}=-1$, вклад: $-1$.
    *   $m\ge3$: аргументы отрицательны, вклад 0.
    *   Итого: $p(5)=8-1=7$. Проверка: разбиения 5: 5; 4+1; 3+2; 3+1+1; 2+2+1; 2+1+1+1; 1+1+1+1+1 – всего 7.

---

#### **5. Ограниченные разбиения**

*   **Разбиения на части, не превосходящие $m$:** Производящая функция:
    $$
    \prod_{i=1}^{m} \frac{1}{1 - x^i}.
    $$
*   **Разбиения не более чем на $m$ частей:** Число таких разбиений равно числу разбиений на части, не превосходящие $m$ (по свойству сопряжения).
*   **Разбиения на ровно $m$ частей:** Можно выразить через рекуррентное соотношение:
    $$
    p_m(n) = p_{m-1}(n-1) + p_m(n-m),
    $$
    с начальными условиями: $p_0(0)=1$, $p_0(n)=0$ при $n>0$, и $p_m(n)=0$ при $n<m$.
    *Обоснование:* Разбиения числа $n$ на $m$ частей можно разделить на два класса:
    1.  Те, где минимальная часть равна 1. Удалив эту часть, получим разбиение числа $n-1$ на $m-1$ часть. Число таких: $p_{m-1}(n-1)$.
    2.  Те, где все части не меньше 2. Вычтем 1 из каждой части — получим разбиение числа $n-m$ на $m$ частей (возможно, с частями, равными 0, но в определении части положительны; однако вычитание 1 из каждой части даст положительные числа, так как исходные были ≥2). Число таких: $p_m(n-m)$.

---

#### **6. Асимптотика числа разбиений**

Формула Харди–Рамануджана–Радемахера (без доказательства):
$$
p(n) \sim \frac{1}{4n\sqrt{3}} \exp\left(\pi \sqrt{\frac{2n}{3}}\right), \quad n \to \infty.
$$
Эта формула показывает, что $p(n)$ растёт суперполиномиально, но субэкспоненциально.

---

#### **7. Примеры и задачи**

1.  **Найти число разбиений числа 7 на три части.**
    *   Можно перечислить: $5+1+1,\;4+2+1,\;3+3+1,\;3+2+2$. Всего $p_3(7)=4$.
    *   По рекуррентной формуле: $p_3(7)=p_2(6)+p_3(4)$. Далее $p_2(6)=3$ (разбиения 5+1,4+2,3+3), $p_3(4)=1$ (2+1+1). Итого 4.

2.  **Доказать, что число разбиений числа $n$ на попарно различные части равно числу разбиений числа $n$ на нечётные части.** Это теорема Эйлера, доказанная выше.

3.  **Сколько существует разбиений числа 10, в которых все части чётны?**
    *   Это эквивалентно разбиению числа 5 (поделив все части на 2) без ограничений на чётность. Ответ: $p(5)=7$.

**Заключение:** Теория разбиений — богатый раздел комбинаторики, связанный с теорией чисел, алгеброй (симметрические функции, представления групп) и математической физикой. Основные инструменты: диаграммы Феррерса/Юнга, производящие функции, рекуррентные соотношения. Пентагональная теорема Эйлера и асимптотическая формула Харди–Рамануджана являются классическими результатами.