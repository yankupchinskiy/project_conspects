## **1. ПОСТРОЕНИЕ БЕСКОНЕЧНОЙ ЦЕПНОЙ ДРОБИ**

### **Алгоритм разложения произвольного вещественного числа**

Для любого вещественного числа $\alpha$ строится бесконечная цепная дробь следующим образом:

1. **Инициализация:** $\alpha_0 = \alpha$
2. **Для $i = 0, 1, 2, \dots$:**
   - $q_i = \lfloor \alpha_i \rfloor$ (целая часть)
   - Если $\alpha_i$ целое, процесс завершается (конечная дробь)
   - Иначе: $\alpha_{i+1} = \dfrac{1}{\alpha_i - q_i}$

В результате получаем представление:
$$
\alpha = q_0 + \cfrac{1}{q_1 + \cfrac{1}{q_2 + \cfrac{1}{\ddots}}} = [q_0; q_1, q_2, \dots]
$$

---

## **2. СХОДИМОСТЬ И СВОЙСТВА**

### **Теорема 1.18 (Чередование подходящих дробей)**
Для бесконечной цепной дроби подходящие дроби $\delta_s = \dfrac{P_s}{Q_s}$ обладают свойствами:

1. Чётные подходящие дроби образуют возрастающую последовательность
2. Нечётные подходящие дроби образуют убывающую последовательность
3. Все подходящие дроби приближают $\alpha$ с разных сторон:
   $$
   \delta_0 < \delta_2 < \delta_4 < \cdots < \alpha < \cdots < \delta_5 < \delta_3 < \delta_1
   $$

### **Оценка точности приближения (Следствие 1.6)**
$$
\left|\alpha - \frac{P_s}{Q_s}\right| \leq \frac{1}{Q_s Q_{s+1}} < \frac{1}{Q_s^2}
$$

**Следствие:** Для достижения точности $\epsilon$ достаточно найти $s$ такое, что $Q_s > 1/\sqrt{\epsilon}$.

---

## **3. ПЕРИОДИЧЕСКИЕ ЦЕПНЫЕ ДРОБИ**

### **Определение 1.11**
Бесконечная цепная дробь называется **периодической**, если начиная с некоторого места последовательность звеньев повторяется:
$$
\alpha = [q_0; q_1, \dots, q_m, \overline{q_{m+1}, \dots, q_{m+k}}]
$$
где черта обозначает период длины $k$.

### **Теорема 1.19 (Лагранж)**
Вещественное число $\alpha$ является **квадратичной иррациональностью** (иррациональным корнем квадратного уравнения с целыми коэффициентами) тогда и только тогда, когда его цепная дробь периодична.

**Доказательство (основные идеи):**
1. **Необходимость:** Если $\alpha$ — квадратичная иррациональность, то в процессе разложения все $\alpha_i$ остаются квадратичными иррациональностями, причём их нормы ограничены. Так как различных квадратичных иррациональностей с данной нормой конечное число, последовательность должна стать периодической.
2. **Достаточность:** Если дробь периодична, то $\alpha$ удовлетворяет квадратному уравнению, которое получается из соотношения подходящих дробей.

---

### **Пример 1.19:** Разложение $\sqrt{28}$
$$
\sqrt{28} = [5; \overline{3, 2, 3, 10}]
$$
**Проверка:** 
- $\sqrt{28} \approx 5.2915026$
- Первые подходящие дроби: $5, \frac{16}{3}, \frac{37}{7}, \frac{127}{24}, \frac{1307}{247}, \dots$

---

## **4. ПРИМЕНЕНИЯ ЦЕПНЫХ ДРОБЕЙ**

### **4.1. Наилучшие приближения**

#### **Определение 1.13**
Дробь $\dfrac{a}{b}$ называется **наилучшим приближением** к числу $\alpha$, если не существует дроби $\dfrac{x}{y}$ с $0 < y \leq b$ такой, что:
$$
\left|\alpha - \frac{x}{y}\right| < \left|\alpha - \frac{a}{b}\right|
$$

#### **Теорема 1.20 (Свойство промежутка между подходящими дробями)**
Пусть $\dfrac{a}{b}$ и $\dfrac{c}{d}$ — две последовательные подходящие дроби такие, что:
$$
bc - ad = 1, \quad \frac{c}{d} - \frac{a}{b} = \frac{1}{bd}
$$
Тогда любая дробь $\dfrac{x}{y}$, лежащая между ними, имеет знаменатель $y > \max(b, d)$.

**Следствие 1.8:** Все подходящие дроби (кроме, возможно, первой) являются наилучшими приближениями.

---

### **Пример:** Приближение числа $\pi$
$$
\pi = [3; 7, 15, 1, 292, 1, 1, 1, 2, \dots]
$$
Подходящие дроби:
- $\delta_0 = 3$
- $\delta_1 = \frac{22}{7} \approx 3.142857$ (ошибка ~0.00126)
- $\delta_2 = \frac{333}{106} \approx 3.141509$ (ошибка ~0.000083)
- $\delta_3 = \frac{355}{113} \approx 3.1415929$ (ошибка ~2.7×10⁻⁷)

Дробь $\frac{355}{113}$ даёт 6 верных десятичных знаков и была известна китайскому математику Цзу Чунчжи (V век).

---

### **4.2. Решение уравнения Пелля**

Уравнение Пелля:
$$
x^2 - n y^2 = 1, \quad n \in \mathbb{N} \text{ (не полный квадрат)}
$$

#### **Алгоритм решения:**
1. Разложить $\sqrt{n}$ в периодическую цепную дробь.
2. Пусть период имеет длину $k$.
3. Если $k$ чётно, то фундаментальное решение:
   $$
   (x_1, y_1) = (P_{k-1}, Q_{k-1})
   $$
4. Если $k$ нечётно, то:
   $$
   (x_1, y_1) = (P_{2k-1}, Q_{2k-1})
   $$

#### **Пример:** Решение $x^2 - 7y^2 = 1$
$$
\sqrt{7} = [2; \overline{1, 1, 1, 4}], \quad k = 4 \text{ (чётное)}
$$
Подходящие дроби:
- $\delta_0 = \frac{2}{1}$
- $\delta_1 = \frac{3}{1}$
- $\delta_2 = \frac{5}{2}$
- $\delta_3 = \frac{8}{3}$
- $\delta_4 = \frac{37}{14}$

Фундаментальное решение: $x = 8, y = 3$:
$$
8^2 - 7 \cdot 3^2 = 64 - 63 = 1
$$

---

### **4.3. Календарная задача**

Тропический год ≈ 365.2422 суток. Требуется подобрать календарь с целым числом дней в году.

#### **Разложение в цепную дробь:**
$$
365.2422 = [365; 4, 7, 1, 3, 5, 20, \dots]
$$

#### **Подходящие дроби и соответствующие календарные системы:**

| Подходящая дробь | Значение | Система | Описание |
|-----------------|----------|---------|----------|
| $\delta_0 = 365$ | 365.0000 | Древнеегипетский | 365 дней, ошибка 0.2422 дня/год |
| $\delta_1 = 365\frac{1}{4}$ | 365.2500 | Юлианский | Високосный каждый 4-й год, ошибка -0.0078 дня/год |
| $\delta_2 = 365\frac{7}{29}$ | 365.2414 | — | 29 лет, 7 високосных, ошибка +0.0008 дня/год |
| $\delta_3 = 365\frac{8}{33}$ | 365.2424 | Персидский (Омар Хайям) | 33 года, 8 високосных, ошибка -0.0002 дня/год |
| $\delta_4 = 365\frac{31}{128}$ | 365.2422 | Предложение Медлера | 128 лет, 31 високосный, ошибка +0.0000125 дня/год |
| Григорианский | 365.2425 | Современный | 400 лет, 97 високосных, ошибка -0.0003 дня/год |

**Историческая справка:**
- **46 г. до н.э.**: Юлий Цезарь ввёл юлианский календарь (365.25 суток)
- **1582 г.**: Папа Григорий XIII ввёл григорианский календарь (365.2425 суток)
- **1079 г.**: Омар Хайям предложил календарь с циклом 33 года (365.2424 суток)
- **1864 г.**: Иоганн Медлер предложил календарь с циклом 128 лет (365.2422 суток)

---

### **4.4. Задача о зубчатых колесах (Гюйгенс)**

При конструировании механических устройств (например, планетария) требуется реализовать заданное передаточное отношение $\alpha$ с помощью зубчатых колёс с целыми числами зубцов.

#### **Постановка задачи:**
Найти целые числа зубцов $a$ и $b$ такие, что отношение $\frac{a}{b}$ приближает заданное иррациональное число $\alpha$ (например, отношение периодов планет).

#### **Решение:**
Использовать подходящие дроби разложения $\alpha$ в цепную дробь. Они дают наилучшие приближения с ограничением на знаменатель.

**Пример:** Отношение периода Сатурна к периоду Земли ≈ 29.457 лет. Гюйгенс использовал цепные дроби для подбора чисел зубцов в своём планетарии.

---

### **4.5. Криптография**

Цепные дроби используются в атаках на криптосистемы, например, в **атаке Винера на RSA**.

#### **Условие атаки:**
Если в RSA открытая экспонента $e$ удовлетворяет:
$$
e < N^{1/4} \quad \text{и} \quad d < \frac{1}{3}N^{1/4}
$$
где $N = pq$, то, разлагая $\frac{e}{N}$ в цепную дробь, можно найти подходящую дробь $\frac{k}{d}$, которая с высокой вероятностью равна $\frac{e}{\varphi(N)}$, что позволяет вычислить секретную экспоненту $d$.

#### **Идея:**
Из соотношения $ed \equiv 1 \pmod{\varphi(N)}$ следует:
$$
ed - k\varphi(N) = 1 \quad \Rightarrow \quad \left|\frac{e}{\varphi(N)} - \frac{k}{d}\right| = \frac{1}{d\varphi(N)}
$$
Так как $\varphi(N) \approx N$, то дробь $\frac{k}{d}$ является подходящей дробью для $\frac{e}{N}$.

---

### **4.6. Теория музыки**

Музыкальные интервалы выражаются отношениями частот. Цепные дроби помогают находить рациональные приближения иррациональных интервалов.

**Пример:** Пифагорейский строй основан на чистой квинте с отношением 3:2. Однако 12 таких квинт (3/2)¹² ≈ 129.746 не равно 7 октавам 2⁷ = 128. Разность называется **пифагорейской коммой**:
$$
\left(\frac{3}{2}\right)^{12} / 2^7 = \frac{3^{12}}{2^{19}} \approx 1.01364
$$
Цепные дроби помогают изучать различные музыкальные строи и их приближения.

---

## **5. ВЫЧИСЛИТЕЛЬНЫЕ АСПЕКТЫ**

### **Алгоритм вычисления бесконечной цепной дроби с заданной точностью**

**Вход:** $\alpha \in \mathbb{R}$, точность $\epsilon > 0$.  
**Выход:** Подходящая дробь $\dfrac{P_s}{Q_s}$ такая, что $|\alpha - P_s/Q_s| < \epsilon$.

1. Построить разложение $\alpha$ в цепную дробь, вычисляя последовательно $q_i$ и подходящие дроби.
2. На каждом шаге $s$ проверять условие:
   $$
   \frac{1}{Q_s^2} < \epsilon
   $$
3. Как только условие выполнится, вернуть $\dfrac{P_s}{Q_s}$.

**Замечание:** Так как $Q_s$ растут экспоненциально (не медленнее чисел Фибоначчи), число шагов оценивается как $O(\log(1/\epsilon))$.

---

### **Пример 1.20:** Вычисление $\sqrt{28}$ с точностью $10^{-4}$

Разложение: $[5; 3, 2, 3, 10, 3, 2, 3, 10, \dots]$

| $s$ | $q_s$ | $P_s$ | $Q_s$ | $\delta_s$ | $1/Q_s^2$ |
|------|---------|---------|---------|-------------|-------------|
| 0 | 5 | 5 | 1 | 5.0000 | 1 |
| 1 | 3 | 16 | 3 | 5.3333 | 0.1111 |
| 2 | 2 | 37 | 7 | 5.2857 | 0.0204 |
| 3 | 3 | 127 | 24 | 5.2917 | 0.0017 |
| 4 | 10 | 1307 | 247 | 5.2915 | 0.000016 |

Уже при $s = 3$ точность лучше $10^{-3}$, при $s = 4$ — лучше $10^{-4}$.

---

## **6. ИСТОРИЧЕСКИЕ КОММЕНТАРИИ**

1. **Рафаэль Бомбелли** (1572) — первое использование цепных дробей.
2. **Пьетро Катальди** (1613) — современное обозначение.
3. **Леонард Эйлер** (XVIII в.) — систематическая теория, связь с квадратичными иррациональностями.
4. **Жозеф Луи Лагранж** (1768) — доказательство периодичности для квадратичных иррациональностей.
5. **Христиан Гюйгенс** (XVII в.) — применение в механике (зубчатые колёса).
6. **Эварист Галуа** (1828) — исследование чисто периодических цепных дробей.

---

## **7. ЗАКЛЮЧЕНИЕ**

Бесконечные цепные дроби представляют собой мощный аппарат для:

1. **Приближения чисел:** Наилучшие рациональные приближения с минимальными знаменателями.
2. **Исследования квадратичных иррациональностей:** Характеризация через периодичность.
3. **Решения диофантовых уравнений:** Уравнение Пелля и другие.
4. **Практических задач:** Календарь, механизмы, криптография, теория музыки.

Теория цепных дробей остаётся активной областью исследований, находящей новые применения в компьютерных науках, криптографии и теории чисел.