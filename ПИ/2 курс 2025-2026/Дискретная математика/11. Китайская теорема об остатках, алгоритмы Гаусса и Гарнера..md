#### **1. Китайская теорема об остатках (КТО)**

**Теорема 1.42 (Китайская теорема об остатках).**
Пусть дана система сравнений:
$$
\begin{cases}
x \equiv c_1 \pmod{m_1}, \\
x \equiv c_2 \pmod{m_2}, \\
\quad \vdots \\
x \equiv c_k \pmod{m_k},
\end{cases}
$$
где модули $m_1, m_2, \dots, m_k$ **попарно взаимно просты**, то есть $D(m_i, m_j) = 1$ для всех $i \neq j$.

Тогда:
1.  Система имеет **решение**.
2.  Это решение **единственно по модулю** $M = m_1 \cdot m_2 \cdot \ldots \cdot m_k$.

**Доказательство (конструктивное):**

1.  **Введение обозначений:**
    *   $M = \prod_{i=1}^{k} m_i$ — произведение всех модулей.
    *   $M_l = \frac{M}{m_l}$ для каждого $l = 1, \dots, k$. Заметим, что $M_l$ — это произведение всех модулей, кроме $m_l$.

2.  **Ключевое наблюдение:** Поскольку модули попарно взаимно просты, $M_l$ и $m_l$ также взаимно просты: $D(M_l, m_l) = 1$.

3.  **Построение вспомогательных чисел:** Для каждого $l$ рассмотрим сравнение:
    $$
    M_l \cdot x \equiv 1 \pmod{m_l}.
    $$
    Так как $D(M_l, m_l)=1$, по теореме о разрешимости линейного сравнения (Теорема 1.39) это сравнение имеет **единственное** решение по модулю $m_l$. Обозначим это решение $x_l$. Таким образом:
    $$
    M_l \cdot x_l \equiv 1 \pmod{m_l}. \quad (1)
    $$

4.  **Построение общего решения:** Утверждается, что число
    $$
    x^* = \sum_{l=1}^{k} M_l \cdot x_l \cdot c_l \quad (2)
    $$
    является решением исходной системы.

5.  **Проверка:** Подставим $x^*$ в произвольное сравнение системы с модулем $m_j$.
    *   Все слагаемые в сумме (2), кроме слагаемого с индексом $l=j$, содержат множитель $M_l$, в состав которого входит $m_j$ (так как $M_l$ — произведение всех модулей, кроме $m_l$). Следовательно, каждое такое слагаемое делится на $m_j$:
        $$
        M_l \cdot x_l \cdot c_l \equiv 0 \pmod{m_j} \quad \text{для всех } l \neq j.
        $$
    *   Остаётся проверить слагаемое с $l=j$:
        $$
        M_j \cdot x_j \cdot c_j \equiv 1 \cdot c_j \equiv c_j \pmod{m_j},
        $$
        где мы использовали свойство (1) числа $x_j$.
    *   Суммируя, получаем: $x^* \equiv c_j \pmod{m_j}$. Так как $j$ произвольно, $x^*$ — решение системы.

6.  **Доказательство единственности по модулю M:**
    Предположим, существует два решения $x'$ и $x''$. Тогда для всех $i$:
    $$
    x' \equiv c_i \pmod{m_i} \quad \text{и} \quad x'' \equiv c_i \pmod{m_i}.
    $$
    Вычитая, получим $x' - x'' \equiv 0 \pmod{m_i}$, то есть $m_i \mid (x' - x'')$ для всех $i$. Поскольку модули попарно взаимно просты, по следствию 1.1 (из раздела 1.1.3) их произведение также делит разность:
    $$
    M \mid (x' - x'').
    $$
    Это и означает, что $x' \equiv x'' \pmod{M}$. Следовательно, все решения системы сравнимы между собой по модулю $M$.

**Определение 1.27.** Набор $(c_1, c_2, \dots, c_k)$ называется **китайским кодом** числа $x^*$ по модулям $(m_1, m_2, \dots, m_k)$.

---

#### **2. Алгоритм решения системы на основе КТО (Алгоритм Гаусса)**

Описанное в доказательстве конструктивное построение решения $x^*$ является **алгоритмом Гаусса**.

**Шаги алгоритма:**
1.  **Вычислить** $M = m_1 \cdot m_2 \cdot \ldots \cdot m_k$.
2.  **Для каждого** $i = 1, \dots, k$:
    a. Вычислить $M_i = M / m_i$.
    b. Найти $x_i$ — решение сравнения $M_i \cdot x \equiv 1 \pmod{m_i}$. Это можно сделать с помощью расширенного алгоритма Евклида для чисел $M_i$ и $m_i$, так как $D(M_i, m_i)=1$.
3.  **Вычислить** решение по формуле:
    $$
    x_0 = \sum_{i=1}^{k} M_i \cdot x_i \cdot c_i.
    $$
4.  **Найти** единственное решение в стандартном диапазоне, вычислив $x = x_0 \mod M$ (неотрицательный остаток от деления на $M$).

**Пример 1.43 из учебника:**
Найти наименьшее натуральное $x$:
$$
\begin{cases}
x \equiv 2 \pmod{29}, \\
x \equiv 12 \pmod{20}, \\
x \equiv 20 \pmod{23}, \\
x \equiv 4 \pmod{13}.
\end{cases}
$$

**Решение по алгоритму Гаусса:**
1. $M = 29 \cdot 20 \cdot 23 \cdot 13 = 173420$.
2. $M_1 = 20 \cdot 23 \cdot 13 = 5980$. Нужно решить: $5980 \cdot x \equiv 1 \pmod{29}$. Так как $5980 \mod 29 = 6$, решаем $6x \equiv 1 \pmod{29}$. Решение: $x_1 = 5$ (так как $6 \cdot 5 = 30 \equiv 1 \pmod{29}$).
3. $M_2 = 29 \cdot 23 \cdot 13 = 8671$. $8671 \mod 20 = 11$. Решаем $11x \equiv 1 \pmod{20}$. Решение: $x_2 = 11$.
4. $M_3 = 29 \cdot 20 \cdot 13 = 7540$. $7540 \mod 23 = 21$. Решаем $21x \equiv 1 \pmod{23}$. Решение: $x_3 = 10$.
5. $M_4 = 29 \cdot 20 \cdot 23 = 13340$. $13340 \mod 13 = 4$. Решаем $4x \equiv 1 \pmod{13}$. Решение: $x_4 = 10$.
6. Составляем сумму:
    $$
    x^* = 5980 \cdot 5 \cdot 2 + 8671 \cdot 11 \cdot 12 + 7540 \cdot 10 \cdot 20 + 13340 \cdot 10 \cdot 4
    $$
    $$
    x^* = 59800 + 1144572 + 1508000 + 533600 = 3242972.
    $$
7. Находим результат по модулю $M$:
    $$
    x = 3242972 \mod 173420 = 122552.
    $$
    Это и есть наименьшее натуральное решение.

---

#### **3. Алгоритм Гарнера**

**Важное замечание:** В предоставленном фрагменте учебника **алгоритм Гарнера не описан**. Его изложение, вероятно, содержится в других разделах книги (например, в главах, посвящённых приложениям в криптографии или эффективным вычислениям).

**Краткая суть алгоритма Гарнера (общее знание):**
Это альтернативный метод решения системы сравнений из КТО. В отличие от алгоритма Гаусса, который даёт решение в виде одного (очень большого) числа $x^*$, алгоритм Гарнера представляет решение в **смешанной системе счисления** с основаниями $m_1, m_2, \dots, m_k$.

Он находит коэффициенты $v_1, v_2, \dots, v_k$ такие, что:
$$
x = v_1 + v_2 \cdot m_1 + v_3 \cdot (m_1 m_2) + \dots + v_k \cdot (m_1 m_2 \cdots m_{k-1}),
$$
где $0 \le v_i < m_i$. Это представление удобно для компьютерных вычислений, так как позволяет работать с числами, не превышающими модули, и эффективно выполнять операции (сложение, умножение) по большому модулю $M$.

**Для детального изучения алгоритма Гарнера** необходимо обратиться к полному тексту учебника (разделы, не вошедшие в предоставленный фрагмент).