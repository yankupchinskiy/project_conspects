### **1. Проблема конечности наблюдения сигнала**

#### **1.1. Эффекты усечения сигнала**
При спектральном анализе мы имеем дело с **ограниченным отрезком** сигнала длиной `N` отсчётов. Это эквивалентно умножению бесконечного сигнала `x[n]` на **прямоугольное окно** `w_R[n]`:
```
w_R[n] = 1, при 0 ≤ n ≤ N-1
w_R[n] = 0, в остальных случаях
```
Результирующий сигнал для анализа: `x_w[n] = x[n] · w_R[n]`.

В частотной области это соответствует **свёртке** истинного спектра `X(ω)` с спектром окна `W_R(ω)`:
```
X_w(ω) = (1/2π) ∫_{-π}^{π} X(θ) · W_R(ω - θ) dθ
```

#### **1.2. Спектр прямоугольного окна**
Для прямоугольного окна длины `N`:
```
W_R(ω) = e^{-jω(N-1)/2} · sin(ωN/2) / sin(ω/2)
```
Амплитудный спектр: `|W_R(ω)| = |sin(ωN/2) / sin(ω/2)|` (функция Дирихле).

**Характеристики:**
- **Главный лепесток:** ширина `4π/N` между первыми нулями
- **Боковые лепестки:** первый боковой лепесток на `-13 дБ` относительно главного
- **Уровень боковых лепестков:** медленно убывает (на `6 дБ/октаву`)

### **2. Эффекты оконной обработки**

#### **2.1. Эффект "просачивания" (спектральной утечки)**
Из-за боковых лепестков оконной функции происходит "просачивание" энергии из одной спектральной компоненты в соседние частотные каналы. Особенно заметно для компонент, не кратных частоте `2π/N`.

#### **2.2. Эффект "размытия" спектра**
Конечная длительность окна ограничивает частотное разрешение. Две синусоиды можно разделить, если разность их частот превышает **ширину главного лепестка** оконной функции.

### **3. Основные оконные функции**

#### **3.1. Прямоугольное окно (окно Дирихле)**
```
w[n] = 1, 0 ≤ n ≤ N-1
```
**Параметры:**
- Ширина главного лепестка: `4π/N`
- Уровень первого бокового лепестка: `-13 дБ`
- Спад боковых лепесток: `6 дБ/октава`

**Применение:** Когда важна максимальная разрешающая способность по частоте, а уровень боковых лепестков не критичен.

#### **3.2. Окно Ханна (Хэннинга)**
```
w[n] = 0.5 - 0.5·cos(2πn/(N-1)), 0 ≤ n ≤ N-1
```
**Параметры:**
- Ширина главного лепестка: `8π/N` (в 2 раза шире прямоугольного)
- Уровень первого бокового лепестка: `-32 дБ`
- Спад боковых лепесток: `18 дБ/октава`

**Применение:** Общего назначения, хороший компромисс между разрешением и подавлением боковых лепестков.

#### **3.3. Окно Хэмминга**
```
w[n] = 0.54 - 0.46·cos(2πn/(N-1)), 0 ≤ n ≤ N-1
```
**Параметры:**
- Ширина главного лепестка: `8π/N`
- Уровень первого бокового лепестка: `-43 дБ`
- Спад боковых лепесток: `6 дБ/октава` (после первого лепестка)

**Особенность:** Первый боковой лепесток значительно подавлен, но последующие убывают медленно.

**Применение:** Когда требуется сильное подавление первого бокового лепестка.

#### **3.4. Окно Блэкмана**
```
w[n] = 0.42 - 0.5·cos(2πn/(N-1)) + 0.08·cos(4πn/(N-1)), 0 ≤ n ≤ N-1
```
**Параметры:**
- Ширина главного лепестка: `12π/N` (в 3 раза шире прямоугольного)
- Уровень первого бокового лепестка: `-58 дБ`
- Спад боковых лепесток: `18 дБ/октава`

**Применение:** Когда требуется максимальное подавление боковых лепестков.

### **4. Сравнительные характеристики окон**

| Окно | Ширина главного лепестка | Уровень 1-го бок. лепестка (дБ) | Спад бок. лепестков (дБ/октава) | Эквивалентная шум. полоса |
|------|-------------------------|--------------------------------|--------------------------------|---------------------------|
| Прямоугольное | 4π/N | -13 | 6 | 1.0 |
| Ханна | 8π/N | -32 | 18 | 1.5 |
| Хэмминга | 8π/N | -43 | 6 | 1.36 |
| Блэкмана | 12π/N | -58 | 18 | 1.73 |

**Эквивалентная шумовая полоса** — полоса пропускания фильтра с белым шумом на входе, дающего ту же выходную мощность, что и оконный фильтр.

### **5. Выбор оконной функции**

#### **5.1. Критерии выбора**
1. **Разрешение по частоте:** Определяется шириной главного лепестка. Узкий главный лепесток — лучшее разрешение.
2. **Динамический диапазон:** Определяется уровнем боковых лепестков. Низкие боковые лепестки — лучшее обнаружение слабых компонент на фоне сильных.
3. **Точность амплитудной оценки:** Зависит от плосковершинности главного лепестка.

#### **5.2. Рекомендации**
- **Прямоугольное окно:** Для точного измерения амплитуд и частот, когда сигнал содержит только компоненты, кратные `2π/N`.
- **Окно Ханна:** Универсальное окно общего назначения.
- **Окно Хэмминга:** Когда нужно обнаружить слабый сигнал рядом с сильным.
- **Окно Блэкмана:** Для высоких требований к подавлению боковых лепестков.

### **6. Практические аспекты**

#### **6.1. Перекрытие сегментов (для методов Уэлча)**
При обработке длинных сигналов применяют **метод Уэлча**:
1. Сигнал разбивается на перекрывающиеся сегменты (обычно 50% перекрытие).
2. Каждый сегмент умножается на оконную функцию.
3. Для каждого сегмента вычисляется периодограмма.
4. Усреднение периодограмм даёт оценку спектральной плотности мощности.

**Преимущества:** Уменьшение дисперсии оценки.

#### **6.2. Калибровка амплитуды**
Умножение на окно уменьшает энергию сигнала. Для корректного измерения амплитуд вводят **поправочный коэффициент**:
```
A_corrected = A_measured / (1/N ∑_{n=0}^{N-1} w[n])
```
Для прямоугольного окна: коэффициент = 1, для Ханна: ≈ 1/0.5 = 2.

#### **6.3. Влияние на разрешение**
Эффективное частотное разрешение определяется шириной главного лепестка:
```
Δf_eff = k · fs / N
```
где `k` — коэффициент, зависящий от окна (для прямоугольного: k=1, для Ханна: k=2).

### **7. Математическое обоснование**

#### **7.1. Теорема о свёртке для оконной обработки**
Если `x_w[n] = x[n] · w[n]`, то ДПФ:
```
X_w[k] = ∑_{m=0}^{N-1} X[m] · W[(k-m) mod N]
```
где `W[k]` — ДПФ оконной функции.

Это дискретный аналог свёртки: спектр оконного сигнала есть циклическая свёртка спектра исходного сигнала и спектра окна.

#### **7.2. Пример: синусоида с нецелым числом периодов**
Пусть `x[n] = cos(ω₀n)`, где `ω₀ = 2π·k₀/N`, `k₀` — не целое. При прямоугольном окне:
```
X_w[k] = 0.5·W_R(k - k₀) + 0.5·W_R(k + k₀)
```
Энергия концентрируется не в одном отсчёте ДПФ, а "размазывается" по нескольким отсчётам.

### **8. Специальные оконные функции**

#### **8.1. Окно Кайзера**
Параметрическое окно, позволяющее управлять компромиссом между шириной главного лепестка и уровнем боковых лепестков:
```
w[n] = I₀(β√(1 - [(n - α)/α]²)) / I₀(β), 0 ≤ n ≤ N-1
```
где:
- `α = (N-1)/2`
- `I₀` — модифицированная функция Бесселя первого рода нулевого порядка
- `β` — параметр, управляющий компромиссом

#### **8.2. Окно Дольфа-Чебышева**
Окно с минимальной шириной главного лепестка при заданном уровне боковых лепестков. Все боковые лепестки имеют одинаковую амплитуду.

### **9. Заключение**

Оконная обработка — необходимый этап спектрального анализа конечных отрезков сигналов. Выбор оконной функции представляет собой компромисс между:
1. **Частотным разрешением** (ширина главного лепестка)
2. **Спектральной чистотой** (уровень боковых лепестков)
3. **Точностью амплитудных измерений**

Понимание свойств различных окон позволяет выбирать оптимальную оконную функцию для конкретной задачи анализа сигналов.