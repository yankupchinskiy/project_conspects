# **10. АРИФМЕТИКА И СВОЙСТВА СРАВНЕНИЙ. ЛИНЕЙНЫЕ СРАВНЕНИЯ**

## **1.3.2. АРИФМЕТИКА И СВОЙСТВА СРАВНЕНИЙ**

### **Определение 1.20 (Сравнение по модулю)**
Пусть $a, b, m \in \mathbb{Z}, m > 0$. Говорят, что **а сравнимо с b по модулю m**, и пишут $a \equiv b \pmod{m}$, если $(a - b) : m$.

**Историческая справка:** Знак ≡ для сравнений ввёл Карл Гаусс в 1801 году.

---

### **Теорема 1.25 (Свойства сравнений)**
Отношение сравнения обладает свойствами:
1. **Рефлексивность:** $a \equiv a \pmod{m}$
2. **Симметричность:** $a \equiv b \pmod{m} \Rightarrow b \equiv a \pmod{m}$
3. **Транзитивность:** $a \equiv b \pmod{m}, b \equiv c \pmod{m} \Rightarrow a \equiv c \pmod{m}$

Таким образом, сравнение по модулю является **отношением эквивалентности**.

---

### **Классы вычетов и полные системы вычетов**

#### **Определение 1.21 (Класс вычетов)**
Классом вычетов по модулю m называется множество всех чисел, дающих одинаковый остаток при делении на m.

#### **Теорема 1.26 (Структура множества классов вычетов)**
Все целые числа разбиваются на m классов вычетов по модулю m, причём:
1. Все числа одного класса сравнимы друг с другом
2. Числа из разных классов не сравнимы

#### **Определение 1.22 (Полная система вычетов)**
Полной системой вычетов по модулю m называется набор из m чисел, взятых по одному из каждого класса вычетов.

**Примеры полных систем вычетов:**
1. Наименьшие положительные вычеты: $\{0, 1, 2, \dots, m-1\}$
2. Наименьшие по абсолютной величине вычеты: $\left\{-\frac{m-1}{2}, \dots, -1, 0, 1, \dots, \frac{m-1}{2}\right\}$ для нечётных m

---

### **Теорема 1.27 (Свойства сравнений, связанные с модулем)**
1. Если $a \equiv b \pmod{m}$ и $k \mid m$, то $a \equiv b \pmod{k}$
2. Если $a \equiv b \pmod{m_i}$ для $i = 1, \dots, n$, то $a \equiv b \pmod{M}$, где $M = \text{НОК}(m_1, \dots, m_n)$
3. Если $a \equiv b \pmod{m}$, то $ac \equiv bc \pmod{mc}$
4. Если $a \equiv b \pmod{m_i}$ и $\text{НОД}(m_i, m_j) = 1$ при $i \neq j$, то $a \equiv b \pmod{m_1 m_2 \dots m_k}$

---

### **Теорема 1.28 (Арифметика сравнений)**
Сравнения по одному модулю можно почленно складывать, вычитать и умножать:
1. Если $a \equiv b \pmod{m}$ и $c \equiv d \pmod{m}$, то $a + c \equiv b + d \pmod{m}$
2. Если $a \equiv b \pmod{m}$ и $c \equiv d \pmod{m}$, то $a - c \equiv b - d \pmod{m}$
3. Если $a \equiv b \pmod{m}$ и $c \equiv d \pmod{m}$, то $ac \equiv bd \pmod{m}$

**Следствие 1.11:** Если $a \equiv b \pmod{m}$, то $a^n \equiv b^n \pmod{m}$ для любого $n \in \mathbb{N}$.

---

### **Кольцо вычетов**

#### **Теорема 1.29**
Множество классов вычетов по модулю m (обозначается $\mathbb{Z}_m$, $\mathbb{Z}/(m)$ или $\mathbb{Z}/m\mathbb{Z}$) является **ассоциативным коммутативным кольцом с единицей**.

**Пример 1.31 (Признаки делимости):**
1. Признак делимости на 9: $10 \equiv 1 \pmod{9} \Rightarrow 10^k \equiv 1 \pmod{9}$
   $$
   N = \overline{a_n \dots a_0}_{10} \equiv a_n + \dots + a_0 \pmod{9}
   $$
2. Признак делимости на 11: $10 \equiv -1 \pmod{11} \Rightarrow 10^k \equiv (-1)^k \pmod{11}$
   $$
   N \equiv a_0 - a_1 + a_2 - \dots + (-1)^n a_n \pmod{11}
   $$

---

### **Деление сравнений**

#### **Теорема 1.31 (Сокращение сравнения)**
Если $ac \equiv bc \pmod{m}$ и $d = \text{НОД}(c, m)$, то
$$
a \equiv b \pmod{\frac{m}{d}}
$$

**Следствие 1.12 (Частные случаи):**
1. Если $m \mid c$, то из $ac \equiv bc \pmod{m}$ следует $a \equiv b \pmod{\frac{m}{c}}$
2. Если $\text{НОД}(c, m) = 1$, то из $ac \equiv bc \pmod{m}$ следует $a \equiv b \pmod{m}$

---

### **Теорема 1.32 (Сравнения для целых рациональных функций)**
Пусть $F(a, b, \dots) = \sum_k C_k a^{\alpha_k} b^{\beta_k} \dots$ — целая рациональная функция с целыми коэффициентами.
Если $a \equiv a_1 \pmod{m}$, $b \equiv b_1 \pmod{m}$, ..., то
$$
F(a, b, \dots) \equiv F(a_1, b_1, \dots) \pmod{m}
$$

**Пример (утверждение 1.3):** Квадрат всякого нечётного числа сравним с 1 по модулю 8.
*Доказательство:* Любое нечётное число имеет вид $4k \pm 1$, тогда $(4k \pm 1)^2 = 16k^2 \pm 8k + 1 \equiv 1 \pmod{8}$.

---

## **1.3.4. ЛИНЕЙНЫЕ СРАВНЕНИЯ**

### **Определение 1.26 (Линейное сравнение)**
Уравнение вида
$$
a x \equiv b \pmod{m}
$$
где $a, b, m$ — целые числа, $m > 0$, называется **линейным сравнением**.

---

### **Теорема 1.39 (Критерий разрешимости линейного сравнения)**
Пусть $d = \text{НОД}(a, m)$.

1. **Условие разрешимости:** Сравнение $a x \equiv b \pmod{m}$ разрешимо тогда и только тогда, когда $d \mid b$.

2. **Количество решений:** Если условие выполнено, то существует ровно **d классов решений** по модулю m, которые можно представить в виде:
   $$
   x \equiv x_0 + k \cdot \frac{m}{d} \pmod{m}, \quad k = 0, 1, \dots, d-1
   $$
   где $x_0$ — некоторое частное решение.

**Доказательство:**
1. Разрешимость сравнения эквивалентна разрешимости диофантова уравнения $a x - m y = b$, что по теореме 1.21 равносильно условию $d \mid b$.
2. Все решения диофантова уравнения имеют вид $x = x_0 + \frac{m}{d} t$. По модулю m различных значений будет ровно d при $t = 0, 1, \dots, d-1$.

---

### **Алгоритм 1.17 (Решение линейного сравнения)**

1. Найти $d = \text{НОД}(a, m)$.
2. Если $d \nmid b$, то решений нет.
3. Если $d \mid b$, то:
   - Разделить все коэффициенты и модуль на d:
     $$
     a' = \frac{a}{d}, \quad b' = \frac{b}{d}, \quad m' = \frac{m}{d}
     $$
   - Решить сравнение $a' x \equiv b' \pmod{m'}$, которое имеет единственное решение $x_0$ по модулю $m'$ (так как $\text{НОД}(a', m') = 1$).
   - Исходное сравнение имеет d решений:
     $$
     x \equiv x_0, x_0 + m', x_0 + 2m', \dots, x_0 + (d-1)m' \pmod{m}
     $$

---

### **Пример 1.39:** Решение сравнения $378x \equiv 90 \pmod{120}$

1. $\text{НОД}(378, 120) = 6$, $90 : 6 = 15$ — сравнение разрешимо.
2. Делим на 6: $63x \equiv 15 \pmod{20}$
3. Решаем $63x \equiv 15 \pmod{20}$:
   - $63 \equiv 3 \pmod{20}$, так что $3x \equiv 15 \pmod{20}$
   - Умножаем на обратный к 3 по модулю 20: $3 \cdot 7 = 21 \equiv 1 \pmod{20}$, поэтому $x \equiv 15 \cdot 7 = 105 \equiv 5 \pmod{20}$
1. Решения исходного сравнения: $x \equiv 5 + 20k \pmod{120}$, $k = 0, 1, 2, 3, 4, 5$
   $$
   x \equiv 5, 25, 45, 65, 85, 105 \pmod{120}
   $$

---

### **Нахождение обратного элемента**

В сравнении $a x \equiv 1 \pmod{m}$, если $\text{НОД}(a, m) = 1$, решение x называется **обратным элементом к a по модулю m** и обозначается $a^{-1} \pmod{m}$.

**Пример 1.40:** Найти $65^{-1} \pmod{71}$
- Решаем $65x \equiv 1 \pmod{71}$
- С помощью обобщённого алгоритма Евклида: $65 \cdot (-12) + 71 \cdot 11 = 1$
- Значит, $65 \cdot (-12) \equiv 1 \pmod{71}$
- $x \equiv -12 \equiv 59 \pmod{71}$
- Проверка: $65 \cdot 59 = 3835 = 71 \cdot 54 + 1 \equiv 1 \pmod{71}$

---

### **Теорема 1.40 (Явная формула для решения при простом модуле)**
Если p — простое число, $0 < a < p$, то решение сравнения $a x \equiv b \pmod{p}$ имеет вид:
$$
x \equiv b \cdot (-1)^{a-1} \cdot \frac{C_p^a}{p} \pmod{p}
$$
где $C_p^a$ — биномиальный коэффициент.

**Доказательство основано на том, что:**
$$
(p-1)(p-2)\dots(p-a+1) \equiv (-1)^{a-1} (a-1)! \pmod{p}
$$
и
$$
C_p^a = \frac{p(p-1)\dots(p-a+1)}{a!}
$$

---

### **Теорема 1.41 (Вильсон)**
Натуральное число p > 1 является простым тогда и только тогда, когда
$$
(p-1)! \equiv -1 \pmod{p}
$$

**Доказательство:**
1. **Необходимость:** Если p — простое, то для каждого $a \in \{1, 2, \dots, p-1\}$ существует обратный элемент $a^{-1} \pmod{p}$. При этом $a \equiv a^{-1} \pmod{p}$ только при $a \equiv \pm 1 \pmod{p}$. Поэтому все числа $2, 3, \dots, p-2$ разбиваются на пары взаимно обратных. Их произведение равно 1 по модулю p. Тогда:
   $$
   (p-1)! \equiv 1 \cdot (p-1) \equiv -1 \pmod{p}
   $$
2. **Достаточность:** Если p — составное, то у него есть делитель d такой, что $1 < d < p$. Тогда $d \mid (p-1)!$ и $d \mid p$, поэтому $(p-1)! + 1$ не делится на d, а значит и на p.

---

### **Китайская теорема об остатках (Теорема 1.42)**

#### **Формулировка:**
Система сравнений
$$
\begin{cases}
x \equiv c_1 \pmod{m_1} \\
x \equiv c_2 \pmod{m_2} \\
\vdots \\
x \equiv c_k \pmod{m_k}
\end{cases}
$$
где $\text{НОД}(m_i, m_j) = 1$ при $i \neq j$, имеет единственное решение по модулю $M = m_1 m_2 \dots m_k$.

#### **Алгоритм решения:**
1. Вычислить $M = \prod_{i=1}^k m_i$
2. Для каждого i вычислить $M_i = \frac{M}{m_i}$
3. Для каждого i найти $y_i$ — решение сравнения $M_i y_i \equiv 1 \pmod{m_i}$
4. Решение системы:
   $$
   x \equiv \sum_{i=1}^k c_i M_i y_i \pmod{M}
   $$

#### **Доказательство:**
Проверим, что $x_0 = \sum_{i=1}^k c_i M_i y_i$ удовлетворяет всем сравнениям. Для любого j:
- При $i \neq j$: $M_i$ делится на $m_j$, поэтому $c_i M_i y_i \equiv 0 \pmod{m_j}$
- При $i = j$: $M_j y_j \equiv 1 \pmod{m_j}$, поэтому $c_j M_j y_j \equiv c_j \pmod{m_j}$
Следовательно, $x_0 \equiv c_j \pmod{m_j}$.

Единственность: если $x_1$ и $x_2$ — два решения, то $x_1 - x_2$ делится на все $m_i$, а значит и на их произведение M.

#### **Пример 1.43:** Найти число x, удовлетворяющее:
$$
\begin{cases}
x \equiv 2 \pmod{29} \\
x \equiv 12 \pmod{20} \\
x \equiv 20 \pmod{23} \\
x \equiv 4 \pmod{13}
\end{cases}
$$
- $M = 29 \cdot 20 \cdot 23 \cdot 13 = 173420$
- $M_1 = 20 \cdot 23 \cdot 13 = 5980$, решаем $5980 y_1 \equiv 1 \pmod{29}$
- $5980 \equiv 6 \pmod{29}$, решаем $6 y_1 \equiv 1 \pmod{29}$
- Обратный к 6 по модулю 29: 5 (так как $6 \cdot 5 = 30 \equiv 1 \pmod{29}$)
- Аналогично находим остальные $y_i$
- Вычисляем $x_0 = 2 \cdot 5980 \cdot 5 + 12 \cdot 8660 \cdot 15 + 20 \cdot 7540 \cdot 7 + 4 \cdot 13340 \cdot 8 = 114652$
- Решение: $x \equiv 114652 \pmod{173420}$, наименьшее натуральное решение: 114652

---

## **ПРАКТИЧЕСКИЕ ВЫВОДЫ**

1. **Сравнения** — удобный аппарат для работы с остатками.
2. **Линейные сравнения** решаются аналогично линейным диофантовым уравнениям.
3. **Китайская теорема** позволяет работать с системой сравнений с попарно взаимно простыми модулями.
4. **Теорема Вильсона** даёт красивый, но неэффективный критерий проверки простоты числа.
5. Вся арифметика сравнений сводится к работе в кольцах $\mathbb{Z}_m$.

---


