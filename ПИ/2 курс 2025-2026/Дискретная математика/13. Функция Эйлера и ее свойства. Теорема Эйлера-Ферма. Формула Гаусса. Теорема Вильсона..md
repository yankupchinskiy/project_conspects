### **Конспект по теме: Функция Эйлера и ее свойства. Теорема Эйлера-Ферма. Формула Гаусса. Теорема Вильсона.**
#### **1. Функция Эйлера: определение и основные свойства**

**Определение 1.23.** Функция Эйлера $\varphi(m)$ ставит в соответствие каждому натуральному числу $m$ количество натуральных чисел, не превосходящих $m$ и взаимно простых с $m$.
$$
\varphi(m) = |\{ a \in \mathbb{N} : 1 \le a \le m, \quad D(a, m) = 1 \}|.
$$
Полагают $\varphi(1) = 1$.

**Лемма 1.8.** Для простого числа $p$ и натурального $\alpha$:
$$
\varphi(p^\alpha) = p^\alpha - p^{\alpha-1} = p^\alpha \left(1 - \frac{1}{p}\right).
$$
*Доказательство:* Из чисел $1, 2, \dots, p^\alpha$ на $p$ делятся ровно $p^{\alpha-1}$ чисел: $p, 2p, \dots, p^{\alpha-1}p$. Остальные $p^\alpha - p^{\alpha-1}$ чисел взаимно просты с $p^\alpha$.

**Теорема 1.34 (о полной системе вычетов).** Пусть $x$ пробегает полную систему вычетов по модулю $a$, а $y$ — по модулю $b$, причём $D(a,b)=1$. Тогда:
1.  $z = a y + b x$ пробегает полную систему вычетов по модулю $ab$.
2.  $D(z, ab) = 1$ тогда и только тогда, когда $D(x, a) = 1$ и $D(y, b) = 1$.

**Следствие 1.13 (мультипликативность).** Если $D(a,b)=1$, то:
$$
\varphi(ab) = \varphi(a) \cdot \varphi(b).
$$
*Доказательство:* Из теоремы 1.34 следует, что каждому взаимно простому с $a$ вычету $x$ и взаимно простому с $b$ вычету $y$ соответствует взаимно простой с $ab$ вычет $z$, и такое соответствие взаимно однозначно. Число пар $(x, y)$ равно $\varphi(a)\varphi(b)$.

#### **2. Формула Гаусса для функции Эйлера**

**Теорема (формула Гаусса).** Если каноническое разложение числа $m$ имеет вид $m = p_1^{\alpha_1} p_2^{\alpha_2} \dots p_k^{\alpha_k}$, то:
$$
\varphi(m) = m \cdot \left(1 - \frac{1}{p_1}\right) \cdot \left(1 - \frac{1}{p_2}\right) \cdot \dots \cdot \left(1 - \frac{1}{p_k}\right).
$$

*Доказательство:* Так как простые числа $p_i$ взаимно просты, функция Эйлера мультипликативна (следствие 1.13). Применяя лемму 1.8 для каждого множителя $p_i^{\alpha_i}$, получаем:
$$
\varphi(m) = \varphi(p_1^{\alpha_1}) \cdot \varphi(p_2^{\alpha_2}) \cdot \dots \cdot \varphi(p_k^{\alpha_k}) = p_1^{\alpha_1}\left(1-\frac{1}{p_1}\right) \cdot p_2^{\alpha_2}\left(1-\frac{1}{p_2}\right) \cdot \dots \cdot p_k^{\alpha_k}\left(1-\frac{1}{p_k}\right) = m \prod_{i=1}^{k}\left(1-\frac{1}{p_i}\right).
$$

#### **3. Теорема Эйлера-Ферма**

**Теорема 1.38 (Эйлера-Ферма).** Если целые числа $a$ и $m$ взаимно просты ($D(a,m)=1$), то:
$$
a^{\varphi(m)} \equiv 1 \pmod{m}.
$$

**Доказательство (по Айвори):**
1.  Пусть $\{r_1, r_2, \dots, r_{\varphi(m)}\}$ — приведённая система вычетов по модулю $m$ (все числа, взаимно простые с $m$ и лежащие между 1 и $m$).
2.  Рассмотрим набор чисел $\{a r_1, a r_2, \dots, a r_{\varphi(m)}\}$. Поскольку $D(a, m)=1$ и $D(r_i, m)=1$, то $D(a r_i, m)=1$.
3.  Все числа $a r_i$ попарно несравнимы по модулю $m$. Действительно, если $a r_i \equiv a r_j \pmod{m}$, то, умножая на обратный к $a$ (который существует по теореме 1.39, так как $D(a,m)=1$), получим $r_i \equiv r_j \pmod{m}$, что возможно только при $i=j$.
4.  Следовательно, набор $\{a r_i\}$ также является приведённой системой вычетов по модулю $m$, то есть это те же числа $\{r_1, \dots, r_{\varphi(m)}\}$, но, возможно, в другом порядке.
5.  Перемножим все сравнения: $a r_i \equiv r_{\sigma(i)} \pmod{m}$ для некоторой перестановки $\sigma$. Получим:
    $$
    a^{\varphi(m)} (r_1 r_2 \dots r_{\varphi(m)}) \equiv r_1 r_2 \dots r_{\varphi(m)} \pmod{m}.
    $$
6.  Поскольку все $r_i$ взаимно просты с $m$, на произведение $r_1 \dots r_{\varphi(m)}$ можно сократить (следствие 1.12). В итоге: $a^{\varphi(m)} \equiv 1 \pmod{m}$.

**Следствие 1.15 («малая» теорема Ферма).** Если $p$ — простое число и $p \nmid a$, то:
$$
a^{p-1} \equiv 1 \pmod{p}.
$$
Это частный случай теоремы Эйлера-Ферма, так как для простого $p$ верно $\varphi(p) = p-1$.

#### **4. Теорема Вильсона**

**Теорема 1.41 (Вильсона).** Натуральное число $p > 1$ является простым тогда и только тогда, когда выполняется сравнение:
$$
(p-1)! \equiv -1 \pmod{p}.
$$

**Доказательство:**
1.  **Необходимость (если $p$ простое, то сравнение выполняется).**
    *   Для $p=2$ и $p=3$ проверяется непосредственно: $1! \equiv -1 \pmod{2}$, $2! \equiv -1 \pmod{3}$.
    *   Пусть $p > 3$. Для каждого числа $a$ из множества $\{2, 3, \dots, p-2\}$ найдётся единственное обратное число $a^{-1}$ по модулю $p$ (так как $p$ простое), причём $a^{-1} \not\equiv a \pmod{p}$, иначе $a^2 \equiv 1 \pmod{p} \Rightarrow (a-1)(a+1) \vdots p$, что при $1 < a < p-1$ невозможно.
    *   Таким образом, числа в множестве $\{2, 3, \dots, p-2\}$ разбиваются на пары взаимно обратных: $a \cdot a^{-1} \equiv 1 \pmod{p}$.
    *   Перемножив все такие сравнения, получим: $2 \cdot 3 \cdot \dots \cdot (p-2) \equiv 1 \pmod{p}$.
    *   Умножив это сравнение на очевидные $1 \equiv 1 \pmod{p}$ и $(p-1) \equiv -1 \pmod{p}$, получаем $(p-1)! \equiv -1 \pmod{p}$.

2.  **Достаточность (если сравнение выполняется, то $p$ простое).**
    *   Предположим, что $p$ составное, т.е. $p = ab$, где $1 < a \le b < p$.
    *   Тогда $a$ является делителем числа $(p-1)!$, так как $a$ входит в произведение $1 \cdot 2 \cdot \dots \cdot (p-1)$.
    *   Из условия $(p-1)! \equiv -1 \pmod{p}$ следует, что $(p-1)! + 1$ делится на $p$, а значит, и на $a$.
    *   Но $(p-1)!$ делится на $a$, поэтому разность $((p-1)! + 1) - (p-1)! = 1$ также должна делиться на $a$, что невозможно при $a > 1$. Противоречие. Следовательно, $p$ — простое число.

**Важные замечания:**
*   Теорема Вильсона является красивым теоретическим критерием простоты, но её практическое применение для проверки простоты больших чисел неэффективно из-за сложности вычисления факториалов.
*   Теорема тесно связана со структурой мультипликативной группы вычетов по простому модулю.