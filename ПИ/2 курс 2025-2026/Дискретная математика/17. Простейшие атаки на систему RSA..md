 #### **1. Схема с нотариусом (Атака при наличии доверенной третьей стороны)**

Эта атака не является криптоаналитической в чистом виде, а демонстрирует **уязвимость протокола** при некорректном использовании RSA в системе с доверенным лицом (нотариусом).

**1.1. Постановка задачи:**
*   Участники: **Алиса** (отправитель), **Боб** (получатель), **Нотариус** (доверенная третья сторона).
*   Цель: Алиса хочет отправить Бобу сообщение так, чтобы Нотариус мог при необходимости его прочитать (например, по решению суда).

**1.2. Наивная реализация (уязвимая схема):**
1.  Боб генерирует пару RSA-ключей: открытый $(e_B, n_B)$, закрытый $(d_B, n_B)$.
2.  **Ошибка:** Боб передаёт Нотариусу свой **закрытый ключ** $d_B$ для "гарантии".
3.  Алиса шифрует сообщение для Боба: $C = M^{e_B} \mod n_B$.
4.  Нотариус, имея $d_B$, может расшифровать любое сообщение для Боба: $M = C^{d_B} \mod n_B$.

**1.3. Проблема:**
*   Нотариус становится **единой точкой отказа**. Компрометация Нотариуса приводит к компрометации всех сообщений, адресованных Бобу.
*   Нотариус может злоупотреблять своим положением и читать сообщения без санкций.

**1.4. Защита (корректная схема):**
Боб не должен передавать свой закрытый ключ. Вместо этого:
1.  Нотариус генерирует свою пару RSA-ключей: $(e_N, n_N)$, $(d_N, n_N)$.
2.  Боб шифрует сообщение открытым ключом Нотариуса: $C_N = M^{e_N} \mod n_N$.
3.  Нотариус расшифровывает своим закрытым ключом, проверяет сообщение, затем заново шифрует его открытым ключом Боба: $C_B = M^{e_B} \mod n_B$.
4.  Боб расшифровывает сообщение своим закрытым ключом.

В этой схеме Нотариус не знает закрытый ключ Боба и выполняет только санкционированные операции.

---

#### **2. Метод бесключевого чтения (Циклическая атака)**

Эта атака является **криптоаналитической** и эксплуатирует алгебраические свойства RSA. Она позволяет противнику восстановить исходное сообщение $M$ из шифротекста $C$ без знания закрытого ключа $d$, но **только при определённых условиях**.

**2.1. Основа атаки:**
Шифрование RSA — это возведение в степень $e$ по модулю $n$: $C \equiv M^e \pmod{n}$.
Если многократно применять операцию шифрования к шифротексту $C$, можно получить цикл:
$$
C, \quad C^e \mod n, \quad (C^e)^e \mod n = C^{e^2} \mod n, \quad \dots, \quad C^{e^k} \mod n.
$$
Поскольку множество классов вычетов по модулю $n$ конечно, последовательность **обязательно зациклится**. Более того, так как шифрование — биекция, рано или поздно мы вернёмся к исходному шифротексту $C$.

**2.2. Условие успешности атаки:**
Пусть $k$ — наименьшее натуральное число такое, что
$$
C^{e^k} \equiv C \pmod{n}.
$$
Если $k > 1$, то предыдущий элемент в цепочке, $C^{e^{k-1}}$, будет **равен исходному сообщению** $M$.
$$
\text{Если } C^{e^k} \equiv C \pmod{n}, \text{ то } (C^{e^{k-1}})^e \equiv C \pmod{n} \Rightarrow C^{e^{k-1}} \equiv M \pmod{n}.
$$

**2.3. Пример:**
Пусть параметры RSA: $n=3233$, $e=17$ (как в предыдущем примере). Перехвачен шифротекст $C=2790$.
Вычисляем последовательность:
1.  $C_1 = 2790^{17} \mod 3233 = 2790$ (первое же шифрование дало исходный $C$? Нет, это маловероятно. Нужен реальный пример с циклом).
Для иллюстрации предположим, что мы получили:
*   $C_1 = 2790^{17} \mod 3233 = 1234$
*   $C_2 = 1234^{17} \mod 3233 = 5678$
*   $C_3 = 5678^{17} \mod 3233 = 2790 = C$
Тогда $k=3$, и сообщение $M = C_{k-1} = C_2 = 5678$.

**2.4. Когда атака эффективна?**
*   Атака работает, если **длина цикла мала**. В худшем для атакующего случае длина цикла может быть порядка $\varphi(n)$, что делает атаку неосуществимой.
*   Вероятность существования короткого цикла повышается, если:
    *   Числа $p-1$ и $q-1$ имеют **малые простые делители**.
    *   Показатель степени $e$ имеет **малый порядок** по модулю $\lambda(n) = \text{НОК}(p-1, q-1)$.
    *   **Сообщение $M$ само находится в коротком цикле.**

**2.5. Защита от циклической атаки:**
1.  **Выбор "хороших" простых чисел $p$ и $q$:** Они должны быть **безопасными простыми**, то есть числами вида $p = 2p' + 1$, где $p'$ — также простое (простое Софи Жермен). Это гарантирует, что $p-1$ и $q-1$ имеют большой простой делитель, что увеличивает порядок элементов в мультипликативной группе.
2.  **Использование схемы дополнения (padding):** Преобразование сообщения $M$ перед шифрованием (например, OAEP) гарантирует, что входом для RSA будет "случайно" выглядящее большое число, которое с высокой вероятностью не попадёт в короткий цикл.

**Вывод:** Рассмотренные атаки показывают, что безопасность RSA зависит не только от стойкости факторизации, но и от **корректного выбора параметров** и **грамотного использования в криптографических протоколах**. Циклическая атака, хотя и теоретически возможна, на практике маловероятна при соблюдении стандартов. Схема с нотариусом демонстрирует важность принципа "никогда не раскрывать свой закрытый ключ".