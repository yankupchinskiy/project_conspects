# **9. ДИОФАНТОВЫ УРАВНЕНИЯ**

## **1. ОПРЕДЕЛЕНИЯ И ОСНОВНЫЕ ПОНЯТИЯ**

### **Определение 1.14 (Диофантово уравнение)**
Уравнение вида
$$
a x + b y = c,
$$
где $a, b, c$ — заданные целые числа, а $x, y$ — неизвестные целые числа, называется **линейным диофантовым уравнением с двумя неизвестными**.

**Историческая справка:** Диофант Александрийский (III в. н.э.) — автор "Арифметики", в которой систематически изучались уравнения в целых числах. Пьер Ферма (XVII в.) сделал знаменитую пометку на полях "Арифметики" о Великой теореме Ферма.

---

## **2. КРИТЕРИЙ РАЗРЕШИМОСТИ**

### **Теорема 1.21 (Основная теорема о разрешимости)**
Пусть $d = \text{НОД}(a, b)$. Уравнение $a x + b y = c$ разрешимо в целых числах тогда и только тогда, когда $d \mid c$ (т.е. $c$ делится на $d$).

Если условие выполнено, то все решения описываются формулами:
$$
\boxed{
x = x_0 - \frac{b}{d} t, \quad y = y_0 + \frac{a}{d} t, \quad t \in \mathbb{Z}
},
$$
где $(x_0, y_0)$ — некоторое частное решение.

---

### **Доказательство:**
1. **Необходимость:**  
   Если $(x, y)$ — решение, то $a x + b y = c$. Так как $d \mid a$ и $d \mid b$, то $d \mid (a x + b y) = c$.

2. **Достаточность:**  
   Пусть $d \mid c$, тогда $c = d \cdot e$.  
   По теореме Безу существуют целые числа $u, v$ такие, что:
   $$
   a u + b v = d.
   $$
   Умножим обе части на $e$:
   $$
   a (u e) + b (v e) = d e = c.
   $$
   Следовательно, $(x_0 = u e, y_0 = v e)$ — частное решение.

3. **Общий вид решений:**  
   Пусть $(x, y)$ — произвольное решение. Тогда:
   $$
   a (x - x_0) + b (y - y_0) = 0.
   $$
   Обозначим $a' = \frac{a}{d}$, $b' = \frac{b}{d}$. Так как $\text{НОД}(a', b') = 1$, уравнение принимает вид:
   $$
   a' (x - x_0) = -b' (y - y_0).
   $$
   Отсюда $a' \mid b' (y - y_0)$, и поскольку $\text{НОД}(a', b') = 1$, по теореме 1.6 получаем $a' \mid (y - y_0)$.  
   Значит, существует $t \in \mathbb{Z}$ такое, что:
   $$
   y - y_0 = a' t = \frac{a}{d} t.
   $$
   Подставляя в уравнение, находим:
   $$
   x - x_0 = -\frac{b}{d} t.
   $$

---

## **3. АЛГОРИТМ РЕШЕНИЯ**

### **Алгоритм 1.16 (Решение линейного диофантова уравнения)**
**Вход:** Целые числа $a, b, c$.  
**Выход:** Общее решение уравнения $a x + b y = c$ или сообщение о неразрешимости.

1. **Вычисление НОД и коэффициентов Безу:**  
   С помощью обобщённого алгоритма Евклида находим $d = \text{НОД}(|a|, |b|)$ и числа $u, v$ такие, что:
   $$
   |a| \cdot u + |b| \cdot v = d.
   $$

2. **Проверка условия разрешимости:**  
   Если $d \nmid c$, то уравнение не имеет решений.  
   Иначе: $e = \frac{c}{d}$.

3. **Построение частного решения:**  
   $$
   x_0 = u \cdot e \cdot \text{sign}(a), \quad y_0 = v \cdot e \cdot \text{sign}(b),
   $$
   где $\text{sign}(x) = \begin{cases} 1, & x \geq 0 \\ -1, & x < 0 \end{cases}$.

4. **Запись общего решения:**
   $$
   x = x_0 - \frac{b}{d} t, \quad y = y_0 + \frac{a}{d} t, \quad t \in \mathbb{Z}.
   $$

---

## **4. ПРИМЕРЫ РЕШЕНИЯ**

### **Пример 1.24:** Уравнение $126x - 102y = 18$

1. Вычисляем НОД(126, 102) = 6 с помощью обобщённого алгоритма Евклида:
   $$
   126 \cdot 7 + 102 \cdot (-8) = 6.
   $$

2. $18 : 6 = 3$, уравнение разрешимо.

3. Частное решение: $x_0 = 7 \cdot 3 = 21$, $y_0 = (-8) \cdot 3 = -24$.
   Проверка: $126 \cdot 21 - 102 \cdot (-24) = 2646 + 2448 = 5094 \neq 18$.  
   **Ошибка:** Не учтены знаки. Уравнение имеет вид $126x - 102y = 18$.  
   Наше разложение: $126 \cdot 7 + 102 \cdot (-8) = 6$.  
   Умножаем на 3: $126 \cdot 21 + 102 \cdot (-24) = 18$.  
   Но нам нужно $126x - 102y = 18$, т.е. $126x + 102 \cdot (-y) = 18$.  
   Сравнивая, видим: $x_0 = 21$, а $-y_0 = -24$, значит $y_0 = 24$.  
   Или проще: берём $x_0 = 21$, $y_0 = 24$ (с учётом знака в уравнении).

4. Общее решение:
   $$
   x = 21 - \frac{-102}{6} t = 21 + 17t, \quad y = 24 + \frac{126}{6} t = 24 + 21t, \quad t \in \mathbb{Z}.
   $$

---

### **Пример 1.25:** Уравнение $253x - 449y = 1$

1. НОД(253, 449) = 1.  
   Разложение: $253 \cdot (-126) + 449 \cdot 71 = 1$.

2. Уравнение разрешимо, так как 1 делится на 1.

3. Частное решение: $x_0 = -126$, $y_0 = 71$ (знак учтён).  
   Проверка: $253 \cdot (-126) - 449 \cdot 71 = -31878 - 31879 = -63757 \neq 1$.  
   Снова аккуратно: $253x - 449y = 1$.  
   Разложение: $253 \cdot (-126) + 449 \cdot 71 = 1$.  
   Перепишем как $253 \cdot (-126) - 449 \cdot (-71) = 1$.  
   Сравнивая с исходным уравнением: $x_0 = -126$, $y_0 = -71$.  
   Проверка: $253 \cdot (-126) - 449 \cdot (-71) = -31878 + 31879 = 1$. Верно.

4. Общее решение:
   $$
   x = -126 + \frac{-449}{1} t = -126 - 449t, \quad y = -71 - \frac{253}{1} t = -71 - 253t, \quad t \in \mathbb{Z}.
   $$
   Можно записать симметричнее: $x = -126 - 449t$, $y = -71 - 253t$, $t \in \mathbb{Z}$.

---

### **Пример 1.26:** Уравнение $2071x - 2318y = -95$

1. НОД(2071, 2318) = 19.  
   Разложение: $2071 \cdot (-47) + 2318 \cdot 42 = 19$.

2. $-95 : 19 = -5$, уравнение разрешимо.

3. Частное решение: умножаем разложение на $-5$:
   $$
   2071 \cdot (235) + 2318 \cdot (-210) = -95.
   $$
   Переписывая в виде $2071x - 2318y = -95$, получаем:
   $$
   x_0 = 235, \quad y_0 = 210.
   $$
   Проверка: $2071 \cdot 235 - 2318 \cdot 210 = 486685 - 486780 = -95$.

4. Общее решение:
   $$
   x = 235 - \frac{-2318}{19} t = 235 + 122t, \quad y = 210 + \frac{2071}{19} t = 210 + 109t, \quad t \in \mathbb{Z}.
   $$

---

## **5. ОБОБЩЕНИЕ НА СЛУЧАЙ НЕСКОЛЬКИХ ПЕРЕМЕННЫХ**

### **Теорема 1.22 (Разрешимость уравнения с n переменными)**
Уравнение
$$
a_1 x_1 + a_2 x_2 + \cdots + a_n x_n = c
$$
разрешимо в целых числах тогда и только тогда, когда
$$
\text{НОД}(a_1, a_2, \dots, a_n) \mid c.
$$

**Доказательство:**
1. **Необходимость:** Если $(x_1, \dots, x_n)$ — решение, то левая часть делится на $d = \text{НОД}(a_1, \dots, a_n)$, значит и правая часть должна делиться на $d$.

2. **Достаточность:** Докажем индукцией по $n$.  
   **База:** $n = 2$ — доказано в теореме 1.21.  
   **Шаг:** Пусть утверждение верно для $n-1$. Обозначим $d' = \text{НОД}(a_1, \dots, a_{n-1})$.  
   По предположению индукции уравнение
   $$
   a_1 x_1 + \cdots + a_{n-1} x_{n-1} = d'
   $$
   разрешимо. Пусть $(x_1^0, \dots, x_{n-1}^0)$ — его решение.  
   Рассмотрим уравнение
   $$
   d' y + a_n x_n = c.
   $$
   Оно разрешимо, так как $\text{НОД}(d', a_n) = \text{НОД}(a_1, \dots, a_n) \mid c$.  
   Пусть $(y_0, x_n^0)$ — его решение. Тогда
   $$
   a_1 (x_1^0 y_0) + \cdots + a_{n-1} (x_{n-1}^0 y_0) + a_n x_n^0 = d' y_0 + a_n x_n^0 = c.
   $$
   Таким образом, $(x_1^0 y_0, \dots, x_{n-1}^0 y_0, x_n^0)$ — решение исходного уравнения.

---

## **6. ГЕОМЕТРИЧЕСКАЯ ИНТЕРПРЕТАЦИЯ**

Линейное диофантово уравнение $a x + b y = c$ задаёт прямую на плоскости. Целочисленные решения соответствуют точкам с целыми координатами на этой прямой.

Если $d = \text{НОД}(a, b) \mid c$, то прямая содержит бесконечно много целых точек, которые образуют арифметическую прогрессию с шагом $\left(\frac{b}{d}, -\frac{a}{d}\right)$.

---

## **7. НАХОЖДЕНИЕ НЕОТРИЦАТЕЛЬНЫХ РЕШЕНИЙ**

На практике часто требуется найти решения, в которых неизвестные принимают неотрицательные значения (например, при подсчёте числа предметов).

**Алгоритм:**
1. Найти общее решение $x = x_0 - \frac{b}{d} t$, $y = y_0 + \frac{a}{d} t$.
2. Решить неравенства:
   $$
   x_0 - \frac{b}{d} t \geq 0, \quad y_0 + \frac{a}{d} t \geq 0.
   $$
3. Найти целые значения $t$, удовлетворяющие этим неравенствам.

**Пример:** Найти все неотрицательные решения уравнения $126x - 102y = 18$.
- Общее решение: $x = 21 + 17t$, $y = 24 + 21t$.
- Неравенства: $21 + 17t \geq 0 \Rightarrow t \geq -\frac{21}{17} \approx -1.235$, $24 + 21t \geq 0 \Rightarrow t \geq -\frac{24}{21} \approx -1.143$.
- Наименьшее целое $t$, удовлетворяющее обоим неравенствам: $t = -1$.
- При $t = -1$: $x = 4$, $y = 3$.
- При $t = 0$: $x = 21$, $y = 24$.
- При $t = -2$: $x = -13$, $y = -18$ — отрицательные.
- Таким образом, неотрицательные решения: $(4, 3)$ и $(21, 24)$.

---

## **8. СВЯЗЬ С ЦЕПНЫМИ ДРОБЯМИ**

### **Замечание 1.21**
Коэффициенты общего решения диофантова уравнения тесно связаны с подходящими дробями. В частности, если $\frac{a}{b} = [q_0; q_1, \dots, q_k]$ — разложение в цепную дробь, то
$$
\frac{b}{d} = Q_{k-1}, \quad \frac{a}{d} = P_{k-1},
$$
где $P_{k-1}, Q_{k-1}$ — числитель и знаменатель предпоследней подходящей дроби.

**Пример:** Для уравнения $253x - 449y = 1$ разложение $\frac{449}{253} = [1; 1, 3, 1, 4, 1, 15, 1, 3]$ даёт подходящие дроби, и действительно в общем решении коэффициенты при $t$ равны 449 и 253.

---

## **9. ПРИМЕНЕНИЯ**

### **9.1. Криптография**
- **RSA:** Решение уравнения $e d \equiv 1 \pmod{\varphi(n)}$ сводится к диофантову уравнению $e d - k \varphi(n) = 1$.
- **Атака Винера:** Использование цепных дробей для нахождения секретной экспоненты.

### **9.2. Комбинаторные задачи**
- **Задача о размене:** Сколькими способами можно выплатить сумму $S$ монетами достоинством $a$ и $b$ рублей?
- **Распределение ресурсов:** Распределить $c$ предметов между двумя типами контейнеров вместимостью $a$ и $b$.

### **9.3. Теория чисел**
- Исследование пифагоровых троек: $x^2 + y^2 = z^2$.
- Решение уравнений Пелля: $x^2 - n y^2 = 1$.

---

## **10. ИСТОРИЧЕСКИЕ КОММЕНТАРИИ**

1. **Диофант Александрийский** (III в.) — "Арифметика", 13 книг, из которых сохранилось 6.
2. **Пьер Ферма** (1601-1665) — изучение диофантовых уравнений, Великая теорема Ферма.
3. **Леонард Эйлер** (XVIII в.) — систематическое исследование диофантовых уравнений.
4. **Аксель Туэ** (начало XX в.) — теорема Туэ о конечности числа решений некоторых диофантовых уравнений.

---

## **11. ВОПРОСЫ И ЗАДАЧИ**

1. **Задача 1:** Решить уравнение $4636x + 4389y = -171$.
   
   **Решение:**
   - НОД(4636, 4389) = 19.
   - Разложение: $4636 \cdot (-47) + 4389 \cdot 50 = 19$.
   - $-171 : 19 = -9$.
   - Частное решение: $x_0 = (-47) \cdot (-9) = 423$, $y_0 = 50 \cdot (-9) = -450$.
   - Общее решение: $x = 423 + \frac{4389}{19} t = 423 + 231t$, $y = -450 - \frac{4636}{19} t = -450 - 244t$, $t \in \mathbb{Z}$.

1. **Задача 2:** Решить уравнение $1534x + 1547y = 26$.
   
   **Решение:**
   - НОД(1534, 1547) = 13.
   - Разложение: $1534 \cdot (-47) + 1547 \cdot 47 = 13$.
   - $26 : 13 = 2$.
   - Частное решение: $x_0 = -94$, $y_0 = 94$.
   - Общее решение: $x = -94 + 119t$, $y = 94 - 118t$, $t \in \mathbb{Z}$.

1. **Задача 3:** Решить уравнение $2461x - 2438y = -115$.
   
   **Решение:**
   - НОД(2461, 2438) = 23.
   - Разложение: $2461 \cdot (-47) + 2438 \cdot 48 = 23$.
   - $-115 : 23 = -5$.
   - Частное решение: $x_0 = 235$, $y_0 = -240$.
   - Общее решение: $x = 235 + 106t$, $y = -240 + 107t$, $t \in \mathbb{Z}$.

---

## **12. ЗАКЛЮЧЕНИЕ**

Линейные диофантовы уравнения представляют собой фундаментальный объект теории чисел. Их изучение позволяет:

1. **Понимать структуру целых чисел:** Связь с НОД и теоремой Безу.
2. **Решать практические задачи:** Распределение, размен, планирование.
3. **Строить криптографические алгоритмы:** Ключевые уравнения в RSA и других системах.
4. **Исследовать более сложные диофантовы уравнения:** Квадратичные, кубические, экспоненциальные.

Теория диофантовых уравнений продолжает развиваться, оставаясь одной из центральных тем современной теории чисел.