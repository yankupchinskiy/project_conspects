#### **1. Описание алгоритма RSA**

RSA (Rivest–Shamir–Adleman) — асимметричная криптосистема с открытым ключом. Алгоритм включает три этапа: генерацию ключей, шифрование и расшифрование.

**1.1. Генерация ключей:**
1.  Выбираются два **больших простых числа** $p$ и $q$.
2.  Вычисляется их произведение — **модуль** $n$:
    $$
    n = p \cdot q.
    $$
3.  Вычисляется **функция Эйлера** от модуля:
    $$
    \varphi(n) = \varphi(p) \cdot \varphi(q) = (p-1)(q-1).
    $$
4.  Выбирается целое число $e$ такое, что:
    $$
    1 < e < \varphi(n) \quad \text{и} \quad D(e, \varphi(n)) = 1.
    $$
    Число $e$ называется **открытой экспонентой**.
5.  Вычисляется число $d$ — **закрытая экспонента** — как обратное к $e$ по модулю $\varphi(n)$:
    $$
    d \cdot e \equiv 1 \pmod{\varphi(n)}.
    $$
    Это вычисляется с помощью расширенного алгоритма Евклида, так как $e$ и $\varphi(n)$ взаимно просты.
6.  **Пара $(e, n)$** публикуется как **открытый ключ**.
    **Пара $(d, n)$** хранится в секрете как **закрытый ключ**. Числа $p, q, \varphi(n)$ должны быть уничтожены или надёжно защищены.

**1.2. Шифрование:**
Сообщение $M$ (число, меньшее $n$) шифруется с помощью открытого ключа $(e, n)$ по формуле:
$$
C = M^e \mod n,
$$
где $C$ — шифротекст.

**1.3. Расшифрование:**
Для расшифрования используется закрытый ключ $(d, n)$:
$$
M' = C^d \mod n.
$$
При корректной работе алгоритма $M' = M$.

---

#### **2. Доказательство корректности (Обоснование с помощью теоремы Эйлера-Ферма)**

**Теорема.** Если $M$ взаимно просто с $n$ (т.е. $D(M, n) = 1$), то после расшифрования получится исходное сообщение: $M' = M$.

*Доказательство:*
По построению $d \cdot e \equiv 1 \pmod{\varphi(n)}$, значит, существует целое $k$ такое, что:
$$
e \cdot d = 1 + k \cdot \varphi(n).
$$
Тогда:
$$
C^d \equiv (M^e)^d = M^{e \cdot d} = M^{1 + k \cdot \varphi(n)} = M \cdot (M^{\varphi(n)})^k \pmod{n}.
$$
По **теореме Эйлера-Ферма**, так как $D(M, n)=1$, выполняется $M^{\varphi(n)} \equiv 1 \pmod{n}$. Следовательно:
$$
C^d \equiv M \cdot 1^k \equiv M \pmod{n}.
$$
Что и требовалось доказать.

**Замечание.** На практике $M$ может не быть взаимно простым с $n$. Однако если $M$ кратно $p$ или $q$, доказательство несколько сложнее, но итоговое равенство $M' = M$ всё равно выполняется (это следует из китайской теоремы об остатках и малой теоремы Ферма). В учебнике, вероятно, приводится полное доказательство для общего случая.

---

#### **3. Пример работы алгоритма (упрощённый)**

*   **Генерация ключей:**
    1.  Выбираем простые $p = 61$, $q = 53$.
    2.  Вычисляем $n = 61 \cdot 53 = 3233$.
    3.  Вычисляем $\varphi(n) = (61-1)(53-1) = 60 \cdot 52 = 3120$.
    4.  Выбираем $e = 17$ (взаимно простое с 3120).
    5.  Находим $d$ такое, что $17 \cdot d \equiv 1 \pmod{3120}$. С помощью расширенного алгоритма Евклида находим $d = 2753$ (так как $17 \cdot 2753 = 46801 = 1 + 15 \cdot 3120$).
    6.  **Открытый ключ:** $(e=17, n=3233)$. **Закрытый ключ:** $(d=2753, n=3233)$.

*   **Шифрование:** Пусть сообщение $M = 65$.
    $$
    C = 65^{17} \mod 3233.
    $$
    Используя алгоритм быстрого возведения в степень, получаем $C = 2790$.

*   **Расшифрование:**
    $$
    M' = 2790^{2753} \mod 3233.
    $$
    Снова применяя быстрое возведение, получаем $M' = 65$, что равно исходному сообщению.

---

#### **4. Особенности и безопасность RSA**

*   **Стойкость** основывается на сложности задачи **разложения больших чисел на простые множители (факторизации)**. Зная открытый ключ $(e, n)$, для нахождения закрытого ключа $d$ необходимо знать $\varphi(n) = (p-1)(q-1)$, что эквивалентно знанию $p$ и $q$. При достаточно больших $p$ и $q$ (сейчас рекомендуемая длина — 2048 бит и более) факторизация $n$ является вычислительно неосуществимой задачей.
*   **Практические аспекты:**
    *   Сообщение $M$ должно быть меньше $n$. Для шифрования длинных данных их разбивают на блоки.
    *   На практике часто выбирают $e = 65537$ (простое число Ферма), так как оно имеет только две единицы в двоичной записи, что ускоряет шифрование.
    *   Для повышения эффективности при расшифровании используют **китайскую теорему об остатках (КТО)**, вычисляя $C^d \mod n$ через вычисления по модулям $p$ и $q$.
*   **Атаки:** В учебнике, вероятно, рассматриваются простейшие атаки (например, атака на подобранный шифротекст, атака при малом значении $e$ или $d$). Безопасная реализация требует внимания к выбору параметров и применению схемы дополнения (padding), такой как OAEP.

**Заключение:** RSA — исторически первая и одна из самых распространённых асимметричных криптосистем. Её математическую основу составляют теоремы Эйлера-Ферма и сложность факторизации больших целых чисел.