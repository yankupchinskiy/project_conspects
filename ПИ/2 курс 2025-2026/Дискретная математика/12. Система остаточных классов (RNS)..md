### **Конспект по теме: Система остаточных классов (RNS)**

**Важное замечание:** В предоставленном фрагменте учебника (стр. 1-93) раздел **1.3.6 "Система остаточных классов"** приведён только в виде заголовка. Его полное содержание отсутствует. Поэтому данный конспект составлен на основе общей математической традиции и логической связи с предыдущим материалом (Китайской теоремой об остатках), которая является фундаментом для RNS.

---

#### **1. Определение и основа системы**

Система остаточных классов (Residue Number System, RNS) — это непозиционная система представления чисел, основанная на **Китайской теореме об остатках (КТО)**.

*   **Выбор базиса:** Фиксируется набор попарно взаимно простых натуральных чисел $m_1, m_2, \dots, m_k$, называемых **модулями** (базисом системы).
*   **Диапазон представления:** Вычисляется $M = m_1 \cdot m_2 \cdot \ldots \cdot m_k$.
*   **Представление числа:** Любое целое число $x$ из диапазона $[0, M-1]$ **однозначно** представляется в виде вектора (кортежа) его остатков по выбранным модулям:
    $$
    x \longleftrightarrow (x_1, x_2, \dots, x_k), \quad \text{где } x_i = x \bmod m_i, \quad i = 1, \dots, k.
    $$
    Набор $(x_1, \dots, x_k)$ называется **китайским кодом** числа $x$ (см. Определение 1.27).

#### **2. Арифметические операции в RNS**

Главное вычислительное преимущество RNS заключается в том, что арифметические операции над целыми числами в пределах диапазона $[0, M)$ заменяются на **параллельные операции над их остатками** по соответствующим модулям.

Пусть числа $a$ и $b$ представлены в RNS:
$$
a \leftrightarrow (a_1, a_2, \dots, a_k), \quad b \leftrightarrow (b_1, b_2, \dots, b_k).
$$

Тогда результат операции $c = a \circ b$ (где $\circ$ — это $+, -, \times$) вычисляется **покомпонентно**:
$$
c \leftrightarrow (c_1, c_2, \dots, c_k), \quad \text{где } c_i = (a_i \circ b_i) \bmod m_i \quad \text{для каждого } i = 1, \dots, k.
$$

*   **Сложение:** $c_i = (a_i + b_i) \bmod m_i$
*   **Вычитание:** $c_i = (a_i - b_i) \bmod m_i$
*   **Умножение:** $c_i = (a_i \cdot b_i) \bmod m_i$

**Обоснование:** Это свойство напрямую следует из теоремы 1.28 об арифметике сравнений. Если $a \equiv a_i \pmod{m_i}$ и $b \equiv b_i \pmod{m_i}$, то $a \circ b \equiv a_i \circ b_i \pmod{m_i}$.

#### **3. Пример работы RNS**

Используем данные из Примера 1.43 (решения системы сравнений). Базис: $m_1=29, m_2=20, m_3=23, m_4=13$, $M = 173420$.

*   Число $a = 122552$ представляется в RNS как:
    $$
    a \rightarrow (122552 \bmod 29,\ 122552 \bmod 20,\ 122552 \bmod 23,\ 122552 \bmod 13) = (2,\ 12,\ 20,\ 4).
    $$
    Это именно правая часть исходной системы сравнений.

*   Пусть $b = 50000$. Его RNS-представление:
    $$
    b \rightarrow (50000 \bmod 29,\ 50000 \bmod 20,\ 50000 \bmod 23,\ 50000 \bmod 13) = (9,\ 0,\ 7,\ 1).
    $$

*   Вычислим $c = a + b = 172552$ **в RNS**:
    $$
    \begin{aligned}
    c_1 &= (2 + 9) \bmod 29 = 11 \\
    c_2 &= (12 + 0) \bmod 20 = 12 \\
    c_3 &= (20 + 7) \bmod 23 = 4 \quad (27 \bmod 23 = 4) \\
    c_4 &= (4 + 1) \bmod 13 = 5
    \end{aligned}
    $$
    Таким образом, $c \leftrightarrow (11, 12, 4, 5)$.

    Проверка: $172552 \bmod 29 = 11$, $172552 \bmod 20 = 12$, $172552 \bmod 23 = 4$, $172552 \bmod 13 = 5$. Результат корректен.

#### **4. Преимущества и проблемы RNS**

**Преимущества:**
*   **Параллелизм:** Операции над разрядами (остатками) производятся независимо и одновременно, что потенциально увеличивает скорость вычислений.
*   **Отсутствие переносов:** В отличие от позиционных систем, операции в RNS не создают межразрядных переносов, что упрощает аппаратную реализацию.
*   **Модульность:** Систему можно масштабировать, добавляя новые взаимно простые модули.

**Проблемы и задачи:**
1.  **Сравнение чисел и определение знака:** В RNS эти операции являются глобальными и требуют преобразования числа в позиционную систему или использования специальных алгоритмов.
2.  **Деление и обнаружение переполнения:** Также являются сложными (не модульными) операциями в RNS.
3.  **Преобразование представлений:** Требуются эффективные алгоритмы для:
    *   **Прямого преобразования:** Из позиционного представления в RNS (вычисление остатков по модулям).
    *   **Обратного преобразования:** Из RNS в позиционное представление. Здесь применяется **китайская теорема об остатках**. Алгоритмы Гаусса и Гарнера (последний, вероятно, рассматривается в полной версии учебника) решают именно эту задачу. Алгоритм Гарнера даёт эффективное пообъектное восстановление числа из его остатков.

**Заключение:** RNS — это мощный теоретический и практический инструмент для построения высокопроизводительных вычислительных систем (спецпроцессоров, криптопроцессоров), где основными операциями являются сложение и умножение больших чисел.