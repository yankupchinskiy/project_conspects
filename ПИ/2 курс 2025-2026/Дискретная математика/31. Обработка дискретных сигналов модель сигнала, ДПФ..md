## **Конспект: Обработка дискретных сигналов: модель сигнала, ДПФ**

### **1. Модель дискретного сигнала**

**Дискретный сигнал** — это числовая последовательность, представляющая значения некоторой физической величины (звуковое давление, интенсивность света, напряжение и т.д.) в **дискретные моменты времени**.

#### **1.1. Формальное определение**
Пусть $ T $ — интервал дискретизации (период отсчётов). Тогда **дискретный сигнал** задаётся как последовательность:
$$
x[n] = x(nT), \quad n = 0, 1, 2, \dots, N-1,
$$
где:
* $ x(t) $ — исходный непрерывный сигнал,
* $ n $ — целочисленный индекс (номер отсчёта),
* $ N $ — длина сигнала (число отсчётов).

Для теоретического анализа удобно считать $ T = 1 $ (нормировка по времени) и рассматривать сигнал как **N-мерный вектор**:
$$
\mathbf{x} = (x[0], x[1], \dots, x[N-1])^T.
$$

#### **1.2. Частота дискретизации**
**Частота дискретизации** $ f_s = 1/T $ определяет, сколько отсчётов берётся за единицу времени. Согласно **теореме Котельникова (Найквиста-Шеннона)**, для точного восстановления непрерывного сигнала из дискретного необходимо:
$$
f_s > 2f_{\text{max}},
$$
где $ f_{\text{max}} $ — максимальная частота в спектре исходного сигнала.

---

### **2. Дискретное преобразование Фурье (ДПФ)**

**Дискретное преобразование Фурье** — это математический аппарат для перехода от **временного представления** сигнала к **частотному**.

#### **2.1. Определение ДПФ**
Для дискретного сигнала $ x[n] $ длины $ N $ его **ДПФ** — это последовательность $ X[k] $ длины $ N $, определяемая формулой:
$$
X[k] = \sum_{n=0}^{N-1} x[n] \cdot e^{-j \frac{2\pi}{N} kn}, \quad k = 0, 1, \dots, N-1,
$$
где $ j = \sqrt{-1} $ — мнимая единица.

#### **2.2. Физический смысл коэффициентов ДПФ**
Коэффициент $ X[k] $ соответствует **амплитуде и фазе** гармонической составляющей с частотой:
$$
f_k = \frac{k}{N} f_s \quad (\text{или } \omega_k = \frac{2\pi k}{N}).
$$
* При $ k = 0 $: $ X[0] = \sum_{n=0}^{N-1} x[n] $ — постоянная составляющая (среднее значение).
* При $ k = 1, \dots, \lfloor N/2 \rfloor $: коэффициенты для положительных частот.
* При $ k > N/2 $: коэффициенты для отрицательных частот (в силу периодичности ДПФ).

#### **2.3. Обратное ДПФ (ОДПФ)**
Сигнал может быть точно восстановлен по его ДПФ с помощью **обратного ДПФ**:
$$
x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] \cdot e^{j \frac{2\pi}{N} kn}, \quad n = 0, 1, \dots, N-1.
$$

**Доказательство:** Подставим выражение для $ X[k] $ в формулу ОДПФ:
$$
\frac{1}{N} \sum_{k=0}^{N-1} \left( \sum_{m=0}^{N-1} x[m] e^{-j \frac{2\pi}{N} km} \right) e^{j \frac{2\pi}{N} kn}
= \frac{1}{N} \sum_{m=0}^{N-1} x[m] \sum_{k=0}^{N-1} e^{j \frac{2\pi}{N} k(n-m)}.
$$
Внутренняя сумма равна:
$$
\sum_{k=0}^{N-1} \left( e^{j \frac{2\pi}{N} (n-m)} \right)^k = 
\begin{cases}
N, & \text{если } n - m = 0 \ (\text{mod } N) \\
0, & \text{иначе}
\end{cases}
$$
(сумма геометрической прогрессии). Следовательно, вся выражение равно $ x[n] $.

---

### **3. Основные свойства ДПФ**

Пусть $ x[n] \leftrightarrow X[k] $ и $ y[n] \leftrightarrow Y[k] $ — пары ДПФ.

#### **3.1. Линейность**
$$
\alpha x[n] + \beta y[n] \leftrightarrow \alpha X[k] + \beta Y[k].
$$

#### **3.2. Сдвиг во времени**
Циклический сдвиг сигнала на $ m $ отсчётов:
$$
x[(n-m) \mod N] \leftrightarrow X[k] \cdot e^{-j \frac{2\pi}{N} km}.
$$

#### **3.3. Сдвиг по частоте (модуляция)**
$$
x[n] \cdot e^{j \frac{2\pi}{N} m n} \leftrightarrow X[(k-m) \mod N].
$$

#### **3.4. Теорема о свёртке**
**Циклическая свёртка** двух сигналов длины $ N $:
$$
z[n] = \sum_{m=0}^{N-1} x[m] \cdot y[(n-m) \mod N] \leftrightarrow Z[k] = X[k] \cdot Y[k].
$$

**Доказательство:** Вычислим ДПФ от $ z[n] $:
$$
Z[k] = \sum_{n=0}^{N-1} \sum_{m=0}^{N-1} x[m] y[(n-m) \mod N] e^{-j \frac{2\pi}{N} kn}.
$$
Поменяв порядок суммирования и сделав замену $ l = (n-m) \mod N $, получим произведение $ X[k] \cdot Y[k] $.

#### **3.5. Теорема Парсеваля (сохранение энергии)**
$$
\sum_{n=0}^{N-1} |x[n]|^2 = \frac{1}{N} \sum_{k=0}^{N-1} |X[k]|^2.
$$

---

### **4. Быстрое преобразование Фурье (БПФ)**

**БПФ** — это семейство алгоритмов, позволяющих вычислить ДПФ за время $ O(N \log N) $ вместо наивного $ O(N^2) $.

#### **4.1. Основная идея (алгоритм Кули-Тьюки)**
Разобьём сигнал длины $ N = 2^L $ на две части:
* Чётные отсчёты: $ x_0[n] = x[2n] $,
* Нечётные отсчёты: $ x_1[n] = x[2n+1] $, где $ n = 0, 1, \dots, N/2-1 $.

Тогда ДПФ исходного сигнала можно выразить через ДПФ половинной длины:
$$
X[k] = \sum_{n=0}^{N-1} x[n] W_N^{kn}
= \underbrace{\sum_{n=0}^{N/2-1} x[2n] W_N^{2kn}}_{\text{чётная часть}} + \underbrace{\sum_{n=0}^{N/2-1} x[2n+1] W_N^{k(2n+1)}}_{\text{нечётная часть}},
$$
где $ W_N = e^{-j \frac{2\pi}{N}} $ — **поворачивающий множитель**.

Заметим, что $ W_N^{2kn} = W_{N/2}^{kn} $. Обозначив ДПФ чётной и нечётной частей как $ X_0[k] $ и $ X_1[k] $ (длины $ N/2 $), получим:
$$
X[k] = X_0[k] + W_N^k X_1[k], \quad k = 0, \dots, N-1.
$$
Учитывая периодичность ДПФ половинной длины ($ X_0[k+N/2] = X_0[k] $), достаточно вычислить:
$$
\begin{aligned}
X[k] &= X_0[k] + W_N^k X_1[k], \\
X[k+N/2] &= X_0[k] - W_N^k X_1[k],
\end{aligned} \quad \text{для } k = 0, \dots, N/2-1.
$$

#### **4.2. Вычислительная сложность**
Каждый шаг уменьшает задачу в 2 раза. Общее число операций:
$$
T(N) = 2T(N/2) + O(N) \Rightarrow T(N) = O(N \log N).
$$

**Графическая интерпретация:** «Бабочка» БПФ — элементарная операция:
```
      a[k] --------------> A = a + W * b
           \            /
            \          /
             \        /
              \      /
               \    /
                \  /
      b[k] -------> B = a - W * b
```

---

### **5. Практические аспекты и приложения**

#### **5.1. Спектральный анализ**
ДПФ позволяет разложить сигнал на гармонические компоненты. **Амплитудный спектр**:
$$
A[k] = |X[k]|, \quad \text{Фазовый спектр: } \phi[k] = \arg X[k].
$$

#### **5.2. Фильтрация в частотной области**
1.  Вычислить ДПФ сигнала: $ x[n] \rightarrow X[k] $.
2.  Умножить спектр на частотную характеристику фильтра $ H[k] $: $ Y[k] = X[k] \cdot H[k] $.
3.  Выполнить обратное ДПФ: $ Y[k] \rightarrow y[n] $ (отфильтрованный сигнал).

#### **5.3. Быстрая свёртка**
Для вычисления свёртки длинных последовательностей:
1.  Дополнить последовательности нулями до длины $ N \geq N_1 + N_2 - 1 $.
2.  Вычислить БПФ обеих последовательностей.
3.  Перемножить спектры.
4.  Выполнить обратное БПФ.

**Пример:** Для $ N_1 = N_2 = 1000 $ прямое вычисление свёртки требует ~$ 10^6 $ операций, а БПФ-метод — ~$ 30000 $ операций.

---

### **6. Ограничения и особенности ДПФ**

1.  **Эффект «размывания» спектра (leakage):** возникает из-за конечности анализируемого фрагмента сигнала. Смягчается применением **весовых окон** (Ханна, Хэмминга).
2.  **Частотное разрешение:** определяется как $ \Delta f = f_s / N $. Для повышения разрешения нужно увеличивать длину анализа $ N $.
3.  **Периодичность:** ДПФ предполагает, что сигнал периодичен с периодом $ N $.

**Заключение:** ДПФ и БПФ — фундаментальные инструменты цифровой обработки сигналов, обеспечивающие переход между временным и частотным представлениями с вычислительной эффективностью.