# **8. ЧИСЛА ФИБОНАЧЧИ, ТЕОРЕМА ЦЕКЕНДОРФА, СИСТЕМА СЧИСЛЕНИЯ ФИБОНАЧЧИ**

## **1. ОПРЕДЕЛЕНИЕ И ОСНОВНЫЕ СВОЙСТВА**

### **Определение 1.15 (Числа Фибоначчи)**
Последовательность Фибоначчи задаётся рекуррентным соотношением:
$$
\phi_1 = 1, \quad \phi_2 = 1, \quad \phi_{n+2} = \phi_{n+1} + \phi_n \quad \text{для } n \geq 1
$$

Первые 14 чисел Фибоначчи (приведены Фибоначчи в 1228 году):
$$
1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, \dots
$$

**Историческая справка:**
- Леонардо Пизанский (Фибоначчи, 1180-1240) — средневековый математик, ввёл последовательность в задаче о размножении кроликов.
- Название "числа Фибоначчи" стало общеупотребительным только в XIX веке благодаря математику Эдуару Люка.
- Индийские математики упоминали эти числа ещё в XII веке в связи с ритмическими рисунками в поэзии.

---

### **Формула Бине (Теорема 1.24)**
$$
\phi_n = \frac{\Phi^n - (1-\Phi)^n}{\sqrt{5}}, \quad \text{где } \Phi = \frac{1+\sqrt{5}}{2} \approx 1.6180339
$$

**Доказательство (индукция):**
1. **База:** $n=1$: $\frac{\Phi - (1-\Phi)}{\sqrt{5}} = \frac{\Phi + \Phi - 1}{\sqrt{5}} = \frac{2\Phi - 1}{\sqrt{5}} = \frac{\sqrt{5}}{\sqrt{5}} = 1$
   $n=2$: $\frac{\Phi^2 - (1-\Phi)^2}{\sqrt{5}} = \frac{(\Phi+1) - (2-\Phi)}{\sqrt{5}} = \frac{2\Phi - 1}{\sqrt{5}} = 1$
2. **Шаг:** Предположим верно для $n-1$ и $n$. Тогда:
   $$
   \phi_{n+1} = \phi_n + \phi_{n-1} = \frac{\Phi^n - (1-\Phi)^n}{\sqrt{5}} + \frac{\Phi^{n-1} - (1-\Phi)^{n-1}}{\sqrt{5}}
   $$
   Учитывая, что $\Phi^2 = \Phi + 1$ и $(1-\Phi)^2 = (1-\Phi) + 1$, получаем требуемое.

---

### **Соотношение Кассини (Лемма 1.7)**
$$
\phi_{n-1}\phi_{n+1} - \phi_n^2 = (-1)^n
$$

**Доказательство (индукция):**
- База $n=2$: $\phi_1\phi_3 - \phi_2^2 = 1\cdot2 - 1^2 = 1 = (-1)^2$
- Шаг: $\phi_n\phi_{n+2} - \phi_{n+1}^2 = \phi_n(\phi_{n+1}+\phi_n) - \phi_{n+1}^2 = \phi_n\phi_{n+1} + \phi_n^2 - \phi_{n+1}^2$
  Используя предположение индукции $\phi_{n-1}\phi_{n+1} - \phi_n^2 = (-1)^n$, преобразуем к $-\left(\phi_{n-1}\phi_{n+1} - \phi_n^2\right) = (-1)^{n+1}$

---

## **2. ТЕОРЕМА ЦЕКЕНДОРФА**

### **Формулировка (Теорема 1.23)**
Любое натуральное число $N$ можно представить **единственным образом** в виде суммы различных чисел Фибоначчи, не являющихся соседними в последовательности Фибоначчи:
$$
N = \phi_{k_1} + \phi_{k_2} + \cdots + \phi_{k_r},
$$
где $k_1 > k_2 + 1$, $k_2 > k_3 + 1$, ..., $k_{r-1} > k_r + 1$, $k_r \geq 2$.

**Замечание:** Используются числа Фибоначчи с индексами ≥ 2 ($\phi_2 = 1$, $\phi_3 = 2$, ...), чтобы избежать неоднозначности из-за $\phi_1 = \phi_2 = 1$.

---

### **Доказательство существования (жадный алгоритм)**
Индукция по $N$:
1. **База:** $N=1 = \phi_2$ — выполнено.
2. **Шаг:** Пусть для всех чисел < $N$ утверждение верно. 
   Найдём наибольшее число Фибоначчи $\phi_k \leq N$.
   - Если $\phi_k = N$, то представление найдено.
   - Если $\phi_k < N$, то $N - \phi_k < \phi_{k+1} - \phi_k = \phi_{k-1}$.
   
   По индукционному предположению $N - \phi_k$ имеет представление:
   $$
   N - \phi_k = \phi_{m_1} + \phi_{m_2} + \cdots, \quad m_1 < m_2 < \cdots
   $$
   При этом все $\phi_{m_i} \leq N - \phi_k < \phi_{k-1}$, следовательно $m_1 \leq k-2$.
   Поэтому в представлении $N = \phi_k + \phi_{m_1} + \cdots$ нет соседних чисел Фибоначчи.

---

### **Доказательство единственности**
Предположим, есть два различных представления:
$$
N = \phi_{a_1} + \cdots + \phi_{a_s} = \phi_{b_1} + \cdots + \phi_{b_t}
$$
Пусть $\phi_m$ — наибольшее число Фибоначчи, входящее только в одно из представлений. Без ограничения общности пусть $\phi_m$ входит в первое представление.

Тогда:
$$
\phi_m \leq \text{сумма всех чисел во втором представлении} < \phi_{m+1}
$$
Но сумма всех чисел Фибоначчи < $\phi_m$, не являющихся соседними, равна $\phi_m - 1$ (что доказывается индукцией). Противоречие.

---

### **Примеры представлений:**
$$
\begin{aligned}
6 &= 5 + 1 = \phi_5 + \phi_2 \\
9 &= 8 + 1 = \phi_6 + \phi_2 \\
19 &= 13 + 5 + 1 = \phi_7 + \phi_5 + \phi_2 \\
30 &= 21 + 8 + 1 = \phi_8 + \phi_6 + \phi_2
\end{aligned}
$$

---

## **3. СИСТЕМА СЧИСЛЕНИЯ ФИБОНАЧЧИ**

### **Определение**
Фибоначчиева система счисления — позиционная система счисления с основами, равными числам Фибоначчи $\phi_2, \phi_3, \phi_4, \dots$.

**Правила:**
1. Число записывается в виде двоичной строки $d_k d_{k-1} \dots d_2$, где $d_i \in \{0,1\}$
2. Значение числа: $N = \sum_{i=2}^k d_i \phi_i$
3. **Запрет на соседние единицы:** $d_i \cdot d_{i+1} = 0$ для всех $i$

---

### **Алгоритм перевода числа в фибоначчиеву систему**
**Вход:** $N \in \mathbb{N}$  
**Выход:** Двоичная строка — код Фибоначчи

1. Найти наибольшее число Фибоначчи $\phi_k \leq N$
2. Положить $d_k = 1$, $N := N - \phi_k$
3. Для $i = k-1, k-2, \dots, 2$:
   - Если $\phi_i \leq N$ и $d_{i+1} = 0$, то $d_i = 1$, $N := N - \phi_i$
   - Иначе $d_i = 0$
1. Результат: строка $d_k d_{k-1} \dots d_2$

---

### **Примеры записи:**
$$
\begin{aligned}
6 &= \phi_5 + \phi_2 \quad &\Rightarrow& \quad 1001_Ф \quad (\text{позиции: } \phi_5,\phi_4,\phi_3,\phi_2) \\
9 &= \phi_6 + \phi_2 \quad &\Rightarrow& \quad 100001_Ф \quad (\text{или } 10001, \text{если начинать с } \phi_6) \\
19 &= \phi_7 + \phi_5 + \phi_2 \quad &\Rightarrow& \quad 101001_Ф
\end{aligned}
$$

**Уточнение:** Обычно запись ведут, начиная со старшего разряда, соответствующего наибольшему числу Фибоначчи в разложении.

---

### **Свойства фибоначчиевой системы:**
1. **Единственность:** Каждое число имеет единственное представление (следствие теоремы Цекендорфа).
2. **Избыточность:** Количество разрядов ≈ $\log_\Phi N \approx 1.44 \log_2 N$ (больше, чем в двоичной системе).
3. **Обнаружение ошибок:** Нарушение условия "нет двух единиц подряд" указывает на ошибку.
4. **Эффективность сложения:** Сложение выполняется аналогично двоичному, но с последующей нормализацией (устранением пар 11).

---

## **4. ПРИМЕНЕНИЯ ЧИСЕЛ ФИБОНАЧЧИ**

### **4.1. В природе и искусстве**
- **Растения:** Число лепестков у многих цветов (лилии — 3, лютики — 5, цикорий — 21) являются числами Фибоначчи.
- **Спирали:** Расположение семян в подсолнухе, чешуек в сосновых шишках образуют спирали, количество которых — соседние числа Фибоначчи.
- **Архитектура:** Пропорции Парфенона, пирамиды Хеопса соответствуют золотому сечению.

### **4.2. В информатике**
- **Фибоначчиева куча:** Структура данных для реализации приоритетной очереди с амортизированно эффективными операциями.
- **Метод Фибоначчи:** Оптимальный алгоритм поиска экстремума унимодальной функции на отрезке.
- **Коды Фибоначчи для сжатия:** Префиксные коды для целых чисел, основанные на фибоначчиевой системе.

### **4.3. В комбинаторике**
- Количество способов замостить прямоугольник $2 \times n$ доминошками равно $\phi_{n+1}$.
- Количество бинарных строк длины $n$ без двух единиц подряд равно $\phi_{n+2}$.

---

## **5. КОД ФИБОНАЧЧИ ДЛЯ ЦЕЛЫХ ЧИСЕЛ (СЖАТИЕ)**

### **Алгоритм кодирования:**
1. Представить число в фибоначчиевой системе счисления (по теореме Цекендорфа).
2. Добавить в конец дополнительную единицу (маркер конца числа).
3. Записать полученную битовую строку.

**Пример:** Кодирование числа 9:
- Разложение: $9 = \phi_6 + \phi_2$ → код Цекендорфа: 10001
- Добавляем маркер: 100011
- Итоговый код: 100011

### **Свойства кода:**
- **Префиксность:** Ни одно кодовое слово не является префиксом другого (благодаря маркеру "11").
- **Эффективность:** Длина кода для числа $N$ ≈ $\log_\Phi N + 1$ бит.

---

## **6. ИСТОРИЧЕСКИЕ КОММЕНТАРИИ**

1. **Леонардо Пизанский (Фибоначчи)** (1180-1240) — "Книга абака" (1202), задача о кроликах.
2. **Иоганн Кеплер** (1611) — установил связь с золотым сечением.
3. **Роберт Симсон** (1753) — обнаружил предельное отношение $\phi_{n+1}/\phi_n \to \Phi$.
4. **Эдуард Цекендорф** (1939) — доказал теорему о представлении чисел.
5. **Алексей Стахов** (современность) — развитие фибоначчиевой арифметики.

---

## **7. ВЫЧИСЛИТЕЛЬНЫЕ АСПЕКТЫ**

### **Алгоритм вычисления чисел Фибоначчи:**
1. **Рекурсивный:** $O(\Phi^n)$ — неэффективно.
2. **Итеративный:** $O(n)$ — линейный по $n$.
3. **Быстрое возведение в степень:** Используя формулу Бине и возведение матрицы $\begin{pmatrix}1&1\\1&0\end{pmatrix}^n$, можно получить $O(\log n)$.

### **Проверка принадлежности числа Фибоначчи:**
Число $N$ является числом Фибоначчи тогда и только тогда, когда $5N^2 \pm 4$ — полный квадрат.

---

## **8. СВЯЗЬ С АЛГОРИТМОМ ЕВКЛИДА**

### **Теорема Ламе (Теорема 1.16)**
Наихудший случай для алгоритма Евклида достигается на соседних числах Фибоначчи. Если алгоритму Евклида для обработки $a$ и $b$ требуется ровно $n$ шагов, то наименьшая такая пара — $(\phi_{n+2}, \phi_{n+1})$.

---

## **9. ЗАДАЧИ И ВОПРОСЫ**

1. Сколько различных представлений числа 100 в виде суммы чисел Фибоначчи (без ограничения на соседство)?
2. Докажите, что $\phi_{m+n} = \phi_{m-1}\phi_n + \phi_m\phi_{n+1}$.
3. Найдите фибоначчиево представление числа 100.
4. Предложите алгоритм сложения двух чисел в фибоначчиевой системе счисления.

---

## **10. ЗАКЛЮЧЕНИЕ**

Числа Фибоначчи представляют собой уникальный математический объект, связывающий:
- **Теорию чисел** (теорема Цекендорфа)
- **Комбинаторику** (подсчёт различных конфигураций)
- **Алгоритмику** (оценка сложности алгоритма Евклида)
- **Прикладные науки** (кодирование, архитектура, биология)

Фибоначчиева система счисления демонстрирует, как математическая теория находит применение в современных компьютерных технологиях, особенно в алгоритмах сжатия данных и помехоустойчивого кодирования.